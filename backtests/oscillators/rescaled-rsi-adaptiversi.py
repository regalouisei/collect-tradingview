"""
DS-TV Backtest Results: rescaled-rsi-adaptiversi
============================================================

--- SPY ---
  ERROR: invalid syntax (rescaled-rsi-adaptiversi.py, line 8)

--- BTC ---
  ERROR: invalid syntax (rescaled-rsi-adaptiversi.py, line 8)

--- QQQ ---
  ERROR: invalid syntax (rescaled-rsi-adaptiversi.py, line 8)

============================================================
Unoptimized run. No parameter tuning applied.

Source: TradingView Community Script — rescaled-rsi-adaptiversi
Generated by DeepStack TradingView Pipeline
"""

```python
import numpy as np
import pandas as pd
import pandas_ta as pta
from backtesting import Backtest, Strategy
from backtesting.lib import crossover


class TvStrategy(Strategy):
    # Default parameters from Pine Script
    Length_in = 70
    Length_out = 14

    def __init__(self):
        close = pd.Series(self.data.Close)

        # Helper function to calculate Adaptive Rescaled RSI
        def calc_adaptive_rsi(series, len_in, len_out):
            # Constants
            eps = 1e-10
            
            # Standard Deviations for Logit Transformation
            logit_StDev_in = 2.0 / np.sqrt(len_in - 1.0)
            logit_StDev_out = 2.0 / np.sqrt(len_out - 1.0)
            
            # Smoothing Factor
            sf = 1.0 / len_in
            
            # Calculate 'middle' (EMA of close)
            # Pine: middle := (1.0 - SF) * middle[1] + SF * close
            middle = series.ewm(alpha=sf, adjust=False).mean()
            
            # Calculate 'CC_vol' (EMA of absolute price changes)
            # Pine: CC_vol := (1.0 - SF) * CC_vol[1] + SF * math.abs(close - close[1])
            # Handle initial NaN for diff by setting first value to 0
            delta = series.diff().abs()
            delta.iloc[0] = 0
            cc_vol = delta.ewm(alpha=sf, adjust=False).mean()
            
            # Calculate 'myRSI' (Internal RSI value)
            # Pine: myRSI := 50.0 + 50.0 * ((close - middle) / CC_vol / (Length - 1.0))
            myRSI = 50.0 + 50.0 * ((series - middle) / cc_vol / (len_in - 1.0))
            
            # Clamp RSI slightly away from 0 and 100 to avoid log(0) / log(∞)
            safe_RSI = np.clip(myRSI, eps, 100.0 - eps)
            
            # RSI -> Z-Score
            # Pine: math.log(safe_RSI / (100.0 - safe_RSI)) / logit_StDev_in
            ratio = safe_RSI / (100.0 - safe_RSI)
            RSI_Zscore = np.log(ratio) / logit_StDev_in
            
            # Z-Score -> Output RSI
            # Pine: 100.0 * math.exp(RSI_Zscore * logit_StDev_out) / (1.0 + math.exp(RSI_Zscore * logit_StDev_out))
            exp_term = np.exp(RSI_Zscore * logit_StDev_out)
            output_RSI = 100.0 * exp_term / (1.0 + exp_term)
            
            return output_RSI

        # Wrap indicator calculation