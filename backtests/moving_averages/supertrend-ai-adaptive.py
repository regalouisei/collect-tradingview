"""
DS-TV Backtest Results: supertrend-ai-adaptive
============================================================

--- SPY ---
  ERROR: Can't instantiate abstract class TvStrategy without an implementation for abstract method 'next'

--- BTC ---
  ERROR: Can't instantiate abstract class TvStrategy without an implementation for abstract method 'next'

--- QQQ ---
  ERROR: Can't instantiate abstract class TvStrategy without an implementation for abstract method 'next'

============================================================
Unoptimized run. No parameter tuning applied.

Source: TradingView Community Script â€” supertrend-ai-adaptive
Generated by DeepStack TradingView Pipeline
"""

import numpy as np
import pandas as pd
import pandas_ta as pta
from backtesting import Backtest, Strategy
from backtesting.lib import crossover

class TvStrategy(Strategy):
    param1 = 10
    param2 = 3
    param3 = 14
    param4 = 40
    param5 = 14
    param6 = 20
    param7 = 20
    param8 = 50
    param9 = 20
    param10 = 40
    param11 = 5
    param12 = 70
    param13 = 0.5
    param14 = 10
    param15 = 50
    param16 = 40
    param17 = 0
    param18 = 0.5
    param19 = 1.4
    param20 = 0.9
    param21 = 2
    param22 = 1
    param23 = 0.85
    param24 = 2
    param25 = 0.5
    param26 = 1
    param27 = 0
    param28 = 0.001
    param29 = 0.001
    param30 = 0.001
    param31 = 1
    param32 = -1
    param33 = 0
    param34 = 0
    param35 = 1
    param36 = 0
    param37 = 0
    param38 = 0
    param39 = 0
    param40 = 0
    param41 = 0
    param42 = 0
    param43 = 0
    param44 = 0
    param45 = 0
    param46 = 0
    param47 = 0
    param48 = 0
    param49 = 0
    param50 = 0
    param51 = 0
    param52 = 0
    param53 = 0
    param54 = 0
    param55 = 0
    param56 = 0
    param57 = 0
    param58 = 0
    param59 = 0
    param60 = 0
    param61 = 0
    param62 = 0
    param63 = 0
    param64 = 0
    param65 = 0
    param66 = 0
    param67 = 0
    param68 = 0
    param69 = 0
    param70 = 0
    param71 = 0
    param72 = 0
    param73 = 0
    param74 = 0
    param75 = 0
    param76 = 0
    param77 = 0
    param78 = 0
    param79 = 0
    param80 = 0
    param81 = 0
    param82 = 0
    param83 = 0
    param84 = 0
    param85 = 0
    param86 = 0
    param87 = 0
    param88 = 0
    param89 = 0
    param90 = 0
    param91 = 0
    param92 = 0
    param93 = 0
    param94 = 0
    param95 = 0
    param96 = 0
    param97 = 0
    param98 = 0
    param99 = 0
    param100 = 0
    param101 = 0
    param102 = 0
    param103 = 0
    param104 = 0
    param105 = 0
    param106 = 0
    param107 = 0
    param108 = 0
    param109 = 0
    param110 = 0
    param111 = 0
    param112 = 0
    param113 = 0
    param114 = 0
    param115 = 0
    param116 = 0
    param117 = 0
    param118 = 0
    param119 = 0
    param120 = 0
    param121 = 0
    param122 = 0
    param123 = 0
    param124 = 0
    param125 = 0
    param126 = 0
    param127 = 0
    param128 = 0
    param129 = 0
    param130 = 0
    param131 = 0
    param132 = 0
    param133 = 0
    param134 = 0
    param135 = 0
    param136 = 0
    param137 = 0
    param138 = 0
    param139 = 0
    param140 = 0
    param141 = 0
    param142 = 0
    param143 = 0
    param144 = 0
    param145 = 0
    param146 = 0
    param147 = 0
    param148 = 0
    param149 = 0
    param150 = 0
    param151 = 0
    param152 = 0
    param153 = 0
    param154 = 0
    param155 = 0
    param156 = 0
    param157 = 0
    param158 = 0
    param159 = 0
    param160 = 0
    param161 = 0
    param162 = 0
    param163 = 0
    param164 = 0
    param165 = 0
    param166 = 0
    param167 = 0
    param168 = 0
    param169 = 0
    param170 = 0
    param171 = 0
    param172 = 0
    param173 = 0
    param174 = 0
    param175 = 0
    param176 = 0
    param177 = 0
    param178 = 0
    param179 = 0
    param180 = 0
    param181 = 0
    param182 = 0
    param183 = 0
    param184 = 0
    param185 = 0
    param186 = 0
    param187 = 0
    param188 = 0
    param189 = 0
    param190 = 0
    param191 = 0
    param192 = 0
    param193 = 0
    param194 = 0
    param195 = 0
    param196 = 0
    param197 = 0
    param198 = 0
    param199 = 0
    param200 = 0
    param201 = 0
    param202 = 0
    param203 = 0
    param204 = 0
    param205 = 0
    param206 = 0
    param207 = 0
    param208 = 0
    param209 = 0
    param210 = 0
    param211 = 0
    param212 = 0
    param213 = 0
    param214 = 0
    param215 = 0
    param216 = 0
    param217 = 0
    param218 = 0
    param219 = 0
    param220 = 0
    param221 = 0
    param222 = 0
    param223 = 0
    param224 = 0
    param225 = 0
    param226 = 0
    param227 = 0
    param228 = 0
    param229 = 0
    param230 = 0
    param231 = 0
    param232 = 0
    param233 = 0
    param234 = 0
    param235 = 0
    param236 = 0
    param237 = 0
    param238 = 0
    param239 = 0
    param240 = 0
    param241 = 0
    param242 = 0
    param243 = 0
    param244 = 0
    param245 = 0
    param246 = 0
    param247 = 0
    param248 = 0
    param249 = 0
    param250 = 0
    param251 = 0
    param252 = 0
    param253 = 0
    param254 = 0
    param255 = 0
    param256 = 0
    param257 = 0
    param258 = 0
    param259 = 0
    param260 = 0
    param261 = 0
    param262 = 0
    param263 = 0
    param264 = 0
    param265 = 0
    param266 = 0
    param267 = 0
    param268 = 0
    param269 = 0
    param270 = 0
    param271 = 0
    param272 = 0
    param273 = 0
    param274 = 0
    param275 = 0
    param276 = 0
    param277 = 0
    param278 = 0
    param279 = 0
    param280 = 0
    param281 = 0
    param282 = 0
    param283 = 0
    param284 = 0
    param285 = 0
    param286 = 0
    param287 = 0
    param288 = 0
    param289 = 0
    param290 = 0
    param291 = 0
    param292 = 0
    param293 = 0
    param294 = 0
    param295 = 0
    param296 = 0
    param297 = 0
    param298 = 0
    param299 = 0
    param300 = 0
    param301 = 0
    param302 = 0
    param303 = 0
    param304 = 0
    param305 = 0
    param306 = 0
    param307 = 0
    param308 = 0
    param309 = 0
    param310 = 0
    param311 = 0
    param312 = 0
    param313 = 0
    param314 = 0
    param315 = 0
    param316 = 0
    param317 = 0
    param318 = 0
    param319 = 0
    param320 = 0
    param321 = 0
    param322 = 0
    param323 = 0
    param324 = 0
    param325 = 0
    param326 = 0
    param327 = 0
    param328 = 0
    param329 = 0
    param330 = 0
    param331 = 0
    param332 = 0
    param333 = 0
    param334 = 0
    param335 = 0
    param336 = 0
    param337 = 0
    param338 = 0
    param339 = 0
    param340 = 0
    param341 = 0
    param342 = 0
    param343 = 0
    param344 = 0
    param345 = 0
    param346 = 0
    param347 = 0
    param348 = 0
    param349 = 0
    param350 = 0
    param351 = 0
    param352 = 0
    param353 = 0
    param354 = 0
    param355 = 0
    param356 = 0
    param357 = 0
    param358 = 0
    param359 = 0
    param360 = 0
    param361 = 0
    param362 = 0
    param363 = 0
    param364 = 0
    param365 = 0
    param366 = 0
    param367 = 0
    param368 = 0
    param369 = 0
    param370 = 0
    param371 = 0
    param372 = 0
    param373 = 0
    param374 = 0
    param375 = 0
    param376 = 0
    param377 = 0
    param378 = 0
    param379 = 0
    param380 = 0
    param381 = 0
    param382 = 0
    param383 = 0
    param384 = 0
    param385 = 0
    param386 = 0
    param387 = 0
    param388 = 0
    param389 = 0
    param390 = 0
    param391 = 0
    param392 = 0
    param393 = 0
    param394 = 0
    param395 = 0
    param396 = 0
    param397 = 0
    param398 = 0
    param399 = 0
    param400 = 0
    param401 = 0
    param402 = 0
    param403 = 0
    param404 = 0
    param405 = 0
    param406 = 0
    param407 = 0
    param408 = 0
    param409 = 0
    param410 = 0
    param411 = 0
    param412 = 0
    param413 = 0
    param414 = 0
    param415 = 0
    param416 = 0
    param417 = 0
    param418 = 0
    param419 = 0
    param420 = 0
    param421 = 0
    param422 = 0
    param423 = 0
    param424 = 0
    param425 = 0
    param426 = 0
    param427 = 0
    param428 = 0
    param429 = 0
    param430 = 0
    param431 = 0
    param432 = 0
    param433 = 0
    param434 = 0
    param435 = 0
    param436 = 0
    param437 = 0
    param438 = 0
    param439 = 0
    param440 = 0
    param441 = 0
    param442 = 0
    param443 = 0
    param444 = 0
    param445 = 0
    param446 = 0
    param447 = 0
    param448 = 0
    param449 = 0
    param450 = 0
    param451 = 0
    param452 = 0
    param453 = 0
    param454 = 0
    param455 = 0
    param456 = 0
    param457 = 0
    param458 = 0
    param459 = 0
    param460 = 0
    param461 = 0
    param462 = 0
    param463 = 0
    param464 = 0
    param465 = 0
    param466 = 0
    param467 = 0
    param468 = 0
    param469 = 0
    param470 = 0
    param471 = 0
    param472 = 0
    param473 = 0
    param474 = 0
    param475 = 0
    param476 = 0
    param477 = 0
    param478 = 0
    param479 = 0
    param480 = 0
    param481 = 0
    param482 = 0
    param483 = 0
    param484 = 0
    param485 = 0
    param486 = 0
    param487 = 0
    param488 = 0
    param489 = 0
    param490 = 0
    param491 = 0
    param492 = 0
    param493 = 0
    param494 = 0
    param495 = 0
    param496 = 0
    param497 = 0
    param498 = 0
    param499 = 0
    param500 = 0

    def init(self):
        close = pd.Series(self.data.Close)
        atr = self.I(pta.atr, high=self.data.High, low=self.data.Low, close=close, length=self.param1)
        atrMa = self.I(pta.sma, src=atr, length=self.param4)
        atrRatio = atrMa > 0 and atr / atrMa or 1.0
        upMove = self.data.High - self.data.High.pct_change(1)
        dnMove = self.data.Low.pct_change(1) - self.data.Low
        plusDM = upMove > dnMove and upMove > 0
        minusDM = dnMove > upMove and dnMove > 0
        trueR = self.I(pta.tr, high=self.data.High, low=self.data.Low, close=close)
        smoothTR = self.I(pta.rma, src=trueR, length=self.param5)
        smoothPD = self.I(pta.rma, src=plusDM, length=self.param6)
        smoothND = self.I(pta.rma, src=minusDM, length=self.param6)
        plusDI = smoothTR > 0 and 100 * smoothPD / smoothTR or 0
        minusDI = smoothTR > 0 and 100 * smoothND / smoothTR or 0
        diSum = plusDI + minusDI