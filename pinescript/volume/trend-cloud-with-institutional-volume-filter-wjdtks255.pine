// This Pine ScriptÂ® code is subject to the terms of the Mozilla Public License 2.0 at https://mozilla.org/MPL/2.0/
// Â© wjdtks255

//@version=5
// Trend Cloud with Institutional Volume Filter
// Advanced Trend Tracking with Dynamic Volatility-Adjusted Entry
// Author: wjdtks255
indicator("Trend Cloud with Institutional Volume Filter [wjdtks255]", overlay=true, precision=2)

// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// ðŸ“Œ 1. Parameters & Configuration
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
gp_trend  = "VOLATILITY BAND SETTINGS"
atrPeriod = input.int(10, "ATR Lookback Period", minval=1, group=gp_trend)
factor    = input.float(3.0, "ATR Multiplier (Sensitivity)", step=0.1, group=gp_trend)

gp_filter = "CONVICTION FILTER"
// ì—ëŸ¬ ìˆ˜ì •: 'help' ì¸ìž ì œê±° ì™„ë£Œ
volFilter = input.bool(true, "Institutional Volume Filter", group=gp_filter)

// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// ðŸ“Œ 2. Engine Logic
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[supertrend, direction] = ta.supertrend(factor, atrPeriod)
volAvg = ta.sma(volume, 20)
isVolHigh = volume > volAvg

// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// ðŸ“Œ 3. Visual Layout (Trend Cloud)
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
upColor   = color.new(color.aqua, 75)
downColor = color.new(color.red, 75)
lineColor = direction < 0 ? color.aqua : color.red

plot(supertrend, "Dynamic Trend Line", color=lineColor, linewidth=2)

p1 = plot(close, "Price Anchor", display=display.none)
p2 = plot(supertrend, "Trend Anchor", display=display.none)
fill(p1, p2, color = direction < 0 ? upColor : downColor, title="Trend Momentum Cloud")

// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// ðŸ“Œ 4. Smart Execution Signals
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
buySignal  = ta.change(direction) < 0 and (volFilter ? isVolHigh : true)
sellSignal = ta.change(direction) > 0 and (volFilter ? isVolHigh : true)

// Institutional Entry Labels
plotshape(buySignal,  title="Bullish Entry", style=shape.labelup,   location=location.belowbar, color=color.aqua, text="BUY",  textcolor=color.white, size=size.small)
plotshape(sellSignal, title="Bearish Entry", style=shape.labeldown, location=location.abovebar, color=color.red,  text="SELL", textcolor=color.white, size=size.small)

// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// ðŸ“Œ 5. Automation Alerts
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
alertcondition(buySignal,  title="Trend Change: BUY",  message="Institutional Buy Signal Detected on {{ticker}}")
alertcondition(sellSignal, title="Trend Change: SELL", message="Institutional Sell Signal Detected on {{ticker}}")
