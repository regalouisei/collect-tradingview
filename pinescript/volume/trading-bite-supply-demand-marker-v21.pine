//@version=6
indicator("TRADING BITE Supply Demand Marker V2.1", overlay=false)
// === TRADING BITE ===
// === Version:2.1 ===

// === To identify Supply and Demand Volume bars ===
// === Option to customize Color of Candles  ===
// === Option to customize size of Text on Volume Bars  ===
// === Option to customize Color of Volume Bars  ===


// === INPUTS ===
tf = input.timeframe("", "Volume Analysis Timeframe (leave blank for chart TF)")
bullColor = input.color(color.green, "Bullish Signal Color")
bearColor = input.color(color.red, "Bearish Signal Color")
neutralOverrideColor = input.color(color.gray, "Neutral Volume Bar Color Override (Optional)")
useNeutralOverride = input.bool(false, "Override Neutral Volume Bar Color?")

textSizeInput = input.string("small", "Text Size", options=["tiny", "small", "normal", "large", "huge"])
textColor = input.color(color.white, "Text Color")

enableCandleColor = input.bool(true, "Enable Candle Color Change Based on Volume")

// === FETCH VOLUME & PRICE DATA ===
vol = request.security(syminfo.tickerid, tf, volume)
close_ = request.security(syminfo.tickerid, tf, close)
open_ = request.security(syminfo.tickerid, tf, open)
vol1 = request.security(syminfo.tickerid, tf, volume[1])
vol2 = request.security(syminfo.tickerid, tf, volume[2])

// === LOGIC ===
isBull = close_ > open_
isBear = close_ < open_
volLowerThanPrev2 = vol < vol1 and vol < vol2
showS = isBull and volLowerThanPrev2
showD = isBear and volLowerThanPrev2

// === VOLUME PLOT ===
neutralVolColor = useNeutralOverride ? neutralOverrideColor : isBull ? color.green : isBear ? color.red : color.gray
volColor = showS ? bullColor : showD ? bearColor : neutralVolColor
plot(vol, style=plot.style_columns, color=volColor, title="Volume")

// === CANDLE COLORING BASED ON VOLUME SIGNAL ===
candleColor = enableCandleColor ? (showS ? bullColor : showD ? bearColor : na) : na
barcolor(candleColor)

// === TEXT MARKERS “S” and “D” — with size-specific plotchar ===
plotchar(showS and textSizeInput == "tiny", title="S tiny", char='S', location=location.top, color=textColor, size=size.tiny)
plotchar(showS and textSizeInput == "small", title="S small", char='S', location=location.top, color=textColor, size=size.small)
plotchar(showS and textSizeInput == "normal", title="S normal", char='S', location=location.top, color=textColor, size=size.normal)
plotchar(showS and textSizeInput == "large", title="S large", char='S', location=location.top, color=textColor, size=size.large)
plotchar(showS and textSizeInput == "huge", title="S huge", char='S', location=location.top, color=textColor, size=size.huge)

plotchar(showD and textSizeInput == "tiny", title="D tiny", char='D', location=location.top, color=textColor, size=size.tiny)
plotchar(showD and textSizeInput == "small", title="D small", char='D', location=location.top, color=textColor, size=size.small)
plotchar(showD and textSizeInput == "normal", title="D normal", char='D', location=location.top, color=textColor, size=size.normal)
plotchar(showD and textSizeInput == "large", title="D large", char='D', location=location.top, color=textColor, size=size.large)
plotchar(showD and textSizeInput == "huge", title="D huge", char='D', location=location.top, color=textColor, size=size.huge)


// === TRADING BITE ===
