// This Pine Script® code is subject to the terms of the Mozilla Public License 2.0 at https://mozilla.org/MPL/2.0/
// © UkutaLabs

//@version=6
indicator("Volume Average [UkutaLabs]")
import UkutaLabs/UkutaLabs_General_library/1 as ulgl

color BullishColor = input.color(defval=color.green, title="Bullish", group="Volume Bars")
color BearishColor = input.color(defval=color.red, title="Bearish", group="Volume Bars")
color NeutralColor = input.color(defval=color.gray, title="Below Average", group="Volume Bars")

int LookBackPeriod = input(defval=13, title="Look Back Period (Bars)", group="Average Volume Line")
color LineColor = input.color(defval=color.yellow, title="Line Color", group="Average Volume Line")
int LineWidth = input(defval=2, title="Line Width", group="Average Volume Line")

bool AlertVolume = input.bool(defval=true, title="Above Average Volume", group="Volume Alerts")

plot(volume, "Volume", style = plot.style_columns, color= volume > ta.ema(volume, LookBackPeriod) ? ulgl.isGreenBar() ? BullishColor : BearishColor : NeutralColor)
plot(ta.ema(volume, LookBackPeriod), "VolumeAvg", style = plot.style_line, color= LineColor, linewidth = LineWidth)

float VolumeAvg = ta.ema(volume, LookBackPeriod)
if(AlertVolume and volume > VolumeAvg and barstate.isrealtime)
    alert("Above Average Volume", alert.freq_once_per_bar)

//plotshape(AlertVolume and volume > VolumeAvg, style=shape.circle, location=location.abovebar, color=color.green, size=size.small, force_overlay = true, title="Alert Signal Dot")
