//@version=5
indicator(title="Tick travel â—", overlay=false, max_labels_count = 500, max_lines_count = 500)

// â€”â€”â€”â€”â€”â€”â€”[ variables ]â€”â€”â€”â€”â€”â€”â€”

varip     priceP = array.new_float ()
varip     priceB = array.new_int   ()
varip     priceC = array.new_int   ()
varip     priceT = array.new_string()
var label[]   priceL = array.new_label()
varip t   = 0
varip tC  = 0
varip cl  = close
varip pcl = close

// â€”â€”â€”â€”â€”â€”â€”[ input ]â€”â€”â€”â€”â€”â€”â€”

// â§” âŸœ  â—
str_o   = input.string('Ì£'                       , title=''        , options=['Ì£','.','Ë›','á±¾','ã€‚', 'â—', 'custom']                                  , group='symbol'        , inline='string')
str_c   = input.string('á›§'                       , title='custom'                                                                                 , group='symbol'        , inline='string')
start_o = input.string('ð“'                     , title=''        , options=['áš¦', 'ð“', 'ð«³', 'â³ž', 'â²²', 'âŽ¿', 'âŠ', 'â§”', 'âŸœ', 'â˜¾', 'â˜‰', 'custom'], group='start symbol'  , inline='string2', 
 tooltip='First symbol of each candle')
start_c = input.string('â™ž'                      , title='custom'                                                                                  , group='start symbol'  , inline='string2')


str     = str_o != 'custom' ? str_o : str_c
start   = start_o != 'custom' ? start_o : start_c

s_      = input.string(size.auto                , title='size'         , options=[size.tiny, size.small, size.normal, size.large, size.huge, size.auto])
aSize   = input.int   (500                      , title='array size'   , minval=10, maxval=500)

option  = input.string('tick progression ~ candles (no candles)'       ,
                                                  title='options'      , group  ='options'       , 
 options=['tick progression ~ candles', 'tick progression ~ candles (no candles)', 'tick up/down'])

black   = input.bool  (true                     , title='no candles'   , group  ='candle color'              , tooltip='only tick dots')
c_up    = input.color (#26a69a                  , title=''             , group  ='candle color'  , inline='1')
c_dn    = input.color (#ef5350                  , title=''             , group  ='candle color'  , inline='1')
c_blk   = input.color (color.new(color.black,25), title=''             , group  ='candle color'  , inline='1', tooltip='no candles'    )

// â€”â€”â€”â€”â€”â€”â€”[ the work ]â€”â€”â€”â€”â€”â€”â€”

while array.size(priceL) >= aSize
    label.delete(array.pop(priceL))

if array.size(priceL) >= aSize
    array.pop(priceP)
    array.pop(priceB)
    array.pop(priceC)
    array.pop(priceT)
    
t  += 1

if barstate.isnew
    t := 0
    array.clear(priceP)
    array.clear(priceB)
    array.clear(priceC)
    array.clear(priceT)

if ta.change(t)
    pcl := cl
    cl  := close
    array.unshift(priceP, option == 'tick up/down' ?  t : cl)
    array.unshift(priceB, bar_index)
    array.unshift(priceC, cl > pcl ? 1 : cl < pcl  ? -1 :  0)
    //
    if option != 'tick up/down' 
        txt = ''
        for j = 0 to t
            txt += ' '
        if barstate.isnew
            txt += start
        else    
            txt += str  
        array.unshift(priceT, txt)

if barstate.isrealtime
    tC += 1
    if array.size(priceP) > 1
        for i = 0 to math.min(aSize, array.size(priceP) -1)
            array.unshift(priceL, 
             label.new(
             array.get(priceB, i), 
             array.get(priceP, i), 
             text= 
              option == 'tick up/down' ? '.' : 
              array.get(priceT, i)  , color=na, 
              style=label.style_none, size =s_,
             textcolor=
              array.get(priceC, i) ==  1 ? color.lime : 
              array.get(priceC, i) == -1 ? color.red  : 
                                           color.blue))

// â€”â€”â€”â€”â€”â€”â€”[ plotcandle ]â€”â€”â€”â€”â€”â€”â€”

c_wick   =
 option == 'tick progression ~ candles'              ? close > open ? c_up : c_dn :
 option == 'tick progression ~ candles (no candles)' ?                c_blk       : na

c_border =
 option == 'tick progression ~ candles'              ? close > open ? c_up : c_dn :
 option == 'tick progression ~ candles (no candles)' ?                c_blk       : na

ope = option == 'tick up/down' ? na : open
hi_ = option == 'tick up/down' ? na : high
lo_ = option == 'tick up/down' ? na : low
clo = option == 'tick up/down' ? na : close

plotcandle(ope, hi_, lo_, clo, '', color = color.new(color.black, 100), wickcolor   = c_wick, bordercolor = c_border)

// â€”â€”â€”â€”â€”â€”â€”[ debug ]â€”â€”â€”â€”â€”â€”â€”

//plotchar(tC, "tC", "", location.top, size = size.tiny)
//plotchar(array.size(priceL), "size array labels", "", location.top, size = size.tiny)
