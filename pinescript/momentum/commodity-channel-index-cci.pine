// This Pine Script® code is subject to the terms of the Mozilla Public License 2.0 at https://mozilla.org/MPL/2.0/
// © Tiagorocha1989
//                              ████████╗ ████████╗  ████████╗  ███████╗   ██████╗        ██████╗   ██████╗   ██████╗ ██╗   ██╗ ████████╗
//                              ╚══██╔══╝ ╚══██╔══╝  ██╔═══██║  ██╔════╝  ██╔═══██╗       ██╔══██╗ ██╔═══██╗ ██╔════╝ ██║   ██║ ██╔═══██║
//                                 ██║       ██║     ████████║  ██║ ███║  ██║   ██║       ██████╔╝ ██║   ██║ ██║      ████████║ ████████║
//                                 ██║       ██║     ██╔═══██║  ██║  ██║  ██║   ██║       ██╔══██╗ ██║   ██║ ██║      ██║   ██║ ██╔═══██║
//                                 ██║    ████████╗  ██║   ██║  ███████║  ╚██████╔╝       ██║  ██║ ╚██████╔╝ ╚██████╗ ██║   ██║ ██║   ██║
//@version=6
indicator("Commodity Channel Index", "CCI →",false)
//╔════════════════════════╗
//║ Choose Moving Averages ║
//╚════════════════════════╝
ma(source, length, type) =>
     type == "EMA" ? ta.ema(source, length) :
     type == "SMA" ? ta.sma(source, length) :
     type == "SMMA / RMA" ? ta.rma(source, length) :
     type == "WMA" ? ta.wma(source, length) :
     type == "VWMA" ? ta.vwma(source, length) :
     type == "RMA" ? ta.rma(source, length) :
     type == "HMA" ? ta.hma(source, length) :
     na
//╔════════════════════════╗
//║     INPUT SETTINGS     ║
//╚════════════════════════╝
Length_CCI =    input.int(55, title = "CCI", group="SETTING")
Length_MA =     input.int(30, title = "MA", group="SETTING", inline = "MA")
Source_MA =     input.string("EMA", "", group="SETTING", inline = "MA", options=["EMA", "SMA", "SMMA / RMA", "WMA", "VWMA", "RMA", "HMA"],tooltip = "Moving Averages")
//╔════════════════════════╗
//║      Calculation       ║
//╚════════════════════════╝
CCI =       ta.cci(close,Length_CCI)
CCI_MA =    ma(CCI, Length_MA, Source_MA)
//╔════════════════════════╗
//║          Plot          ║
//╚════════════════════════╝
midLinePlot = plot(50, color = color.new(color.white,50))
Plot_CCI = plot(CCI, color = CCI > 50 ? color.new(#008000, 50):color.new(#FF0000, 50), linewidth = 3)
fill(Plot_CCI, midLinePlot, 200, 0, top_color = color.new(#008000, 50),    bottom_color = color.new(#008000, 100), title = "Overbought Gradient Fill")
fill(Plot_CCI, midLinePlot, 0, -100, top_color = color.new(#FF0000, 100), bottom_color = color.new(#FF0000, 50),    title = "Oversold Gradient Fill")
plot(CCI_MA, color = color.yellow)
isBull = CCI > 50
//╔════════════════════════╗
//║          VIEW          ║
//╚════════════════════════╝
var table Table_CCI = table.new(position.middle_right, 1, 1, border_width = 1)
if barstate.islast
    table.cell(Table_CCI, 0, 0, 
         text = isBull ? "⬆️ Bullish" : "⬇️ Bearish", 
         text_color = isBull ? #008000 : #FF0000,
         text_size = size.huge)
