// This Pine Script® code is subject to the terms of the Mozilla Public License 2.0
// https://mozilla.org/MPL/2.0/
// © AquaTickTrader

//@version=6
//──────────────────────────────────────────────────────────────────────────────
//  [TL5] Trended and Blended (EMA · ALMA · RSI)
//──────────────────────────────────────────────────────────────────────────────
//  Multi-layer trend structure + momentum framework
//
//  COMPONENT STACK:
//     • SMA 8  → Micro structure / execution trigger
//     • ALMA 30 / 80 / 145 → Fast / Intermediate / Macro trend stack
//     • EMA 100 → Institutional mid-term bias
//     • SMA 200 → Macro regime filter
//     • RSI 14 → Momentum confirmation via background bias
//
//  DESIGN PHILOSOPHY:
//     Trade with alignment.
//     Structure + Trend + Regime + Momentum.
//──────────────────────────────────────────────────────────────────────────────

indicator("[TL5] Trended and Blended (EMA · ALMA · RSI)", overlay = true)


//══════════════════════════════════════════════════════════════════════════════
// SHORT-TERM STRUCTURE — SMA 8
//══════════════════════════════════════════════════════════════════════════════
// Used for micro pullbacks and execution refinement.
// Directional coloring reflects immediate slope bias.
//══════════════════════════════════════════════════════════════════════════════

sma8 = ta.sma(close, 8)

plot(
     sma8,
     title     = "SMA 8 (Structure)",
     color     = sma8 > sma8[1] ? color.green : color.red,
     linewidth = 2,
     linestyle = plot.linestyle_dotted
)

plot(
     sma8,
     title     = "SMA 8 (Structure Overlay)",
     color     = sma8 > sma8[1] ? color.green : color.red,
     linewidth = 2,
     linestyle = plot.linestyle_dashed
)


//══════════════════════════════════════════════════════════════════════════════
// ALMA TREND STACK
//══════════════════════════════════════════════════════════════════════════════
// ALMA (Arnaud Legoux Moving Average) reduces lag using Gaussian weighting.
//
// Alignment Logic:
//     30 > 80 > 145 → Bullish stack
//     30 < 80 < 145 → Bearish stack
//══════════════════════════════════════════════════════════════════════════════

// ALMA 30 — Fast Trend
alma30 = ta.alma(close, 30, 0.85, 8)

plot(
     alma30,
     title     = "ALMA 30 (Fast Trend)",
     color     = alma30 > alma30[1] ? color.green : color.red,
     linewidth = 3,
     linestyle = plot.linestyle_dotted
)


// ALMA 80 — Intermediate Trend
alma80 = ta.alma(close, 80, 0.85, 8)

plot(
     alma80,
     title     = "ALMA 80 (Intermediate Trend)",
     color     = alma80 > alma80[1] ? color.black : color.orange,
     linewidth = 2,
     linestyle = plot.linestyle_dashed
)

plot(
     alma80,
     title     = "ALMA 80 (Intermediate Overlay)",
     color     = alma80 > alma80[1] ? color.black : color.orange,
     linewidth = 2,
     linestyle = plot.linestyle_dotted
)


// ALMA 145 — Macro Trend
alma145 = ta.alma(close, 145, 0.85, 8)

plot(
     alma145,
     title     = "ALMA 145 (Macro Trend)",
     color     = alma145 > alma145[1] ? color.black : color.orange,
     linewidth = 3,
     linestyle = plot.linestyle_dotted
)


//══════════════════════════════════════════════════════════════════════════════
// LONG-TERM BIAS — EMA 100
//══════════════════════════════════════════════════════════════════════════════
// Institutional equilibrium level.
//
// Bias Logic:
//     Price > EMA 100 → Prefer long setups
//     Price < EMA 100 → Prefer short setups
//══════════════════════════════════════════════════════════════════════════════

ema100 = ta.ema(close, 100)

plot(
     ema100,
     title     = "EMA 100 (Institutional Bias)",
     color     = ema100 > ema100[1] ? color.black : color.orange,
     linewidth = 3,
     linestyle = plot.linestyle_dotted
)

plot(
     ema100,
     title     = "EMA 100 (Institutional Bias Overlay)",
     color     = ema100 > ema100[1] ? color.black : color.orange,
     linewidth = 3,
     linestyle = plot.linestyle_dashed
)


//══════════════════════════════════════════════════════════════════════════════
// MACRO REGIME FILTER — SMA 200
//══════════════════════════════════════════════════════════════════════════════
// Widely used long-term market regime filter.
//
// Regime Logic:
//     Price > SMA 200 → Bullish market structure
//     Price < SMA 200 → Bearish market structure
//
// Helps avoid trading aggressively against macro flow.
//══════════════════════════════════════════════════════════════════════════════

sma200 = ta.sma(close, 200)

plot(
     sma200,
     title     = "SMA 200 (Macro Regime Filter)",
     color     = sma200 > sma200[1] ? color.black : color.orange,
     linewidth = 4,
     linestyle = plot.linestyle_solid
)


//══════════════════════════════════════════════════════════════════════════════
// MOMENTUM FILTER — RSI 14
//══════════════════════════════════════════════════════════════════════════════
// Directional confirmation layer.
//
// Momentum Logic:
//     RSI > 50 → Bullish momentum
//     RSI < 50 → Bearish momentum
//
// Background coloring provides subtle bias visualization.
//══════════════════════════════════════════════════════════════════════════════

rsi = ta.rsi(close, 14)

// Reserved smoothed RSI for future enhancements
wmarsi = ta.wma(rsi, 14)

bgcolor(
     rsi > 50 ? color.new(color.lime, 80) :
     rsi < 50 ? color.new(color.red, 80)  :
     na
)


//══════════════════════════════════════════════════════════════════════════════
// END OF SCRIPT
//══════════════════════════════════════════════════════════════════════════════
