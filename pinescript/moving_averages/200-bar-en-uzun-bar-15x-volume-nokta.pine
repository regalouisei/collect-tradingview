//@version=5
indicator("200 Bar En Uzun Bar + 1.5x Volume (Nokta)", overlay=true)

lookback = input.int(200, "Referans Bar SayÄ±sÄ±")
volLength = input.int(20, "Volume Ortalama")
strongLookback = 20

barSize = high - low
maxBarSize = ta.highest(barSize, lookback)

longerBar = barSize > maxBarSize[1]

avgVolume = ta.sma(volume, volLength)
highVolume = volume >= avgVolume * 1.5

blueBar = longerBar and not highVolume
redBar  = longerBar and highVolume

// Son 20 bar iÃ§indeki sinyal sayÄ±sÄ± (uyumlu yÃ¶ntem)
signalCount = ta.sma(longerBar ? 1 : 0, strongLookback) * strongLookback
strongSignal = longerBar and signalCount >= 2

// ğŸ¨ BAR RENKLERÄ° (aynÄ± kalÄ±yor)
barcolor(blueBar ? color.blue : redBar ? color.red : na)

// ğŸ”µ NORMAL MAVÄ° NOKTA
plotshape(blueBar, style=shape.circle, location=location.belowbar, color=color.blue, size=size.small)

// ğŸ”´ NORMAL KIRMIZI NOKTA
plotshape(redBar, style=shape.circle, location=location.abovebar, color=color.red, size=size.small)

// ğŸŸ£ GÃœÃ‡LÃœ SÄ°NYAL â€“ Ã‡OK BÃœYÃœK NOKTA (NORMAL NOKTAYA EK OLARAK)
plotshape(strongSignal, style=shape.circle, location=location.belowbar, color=color.purple, size=size.huge)

// ğŸ”” Alert (gÃ¼Ã§lÃ¼ sinyal)
alertcondition(strongSignal, title="GÃœÃ‡LÃœ SÄ°NYAL", message="Son 20 bar iÃ§inde ikinci kez gÃ¼Ã§lÃ¼ sinyal oluÅŸtu!")
