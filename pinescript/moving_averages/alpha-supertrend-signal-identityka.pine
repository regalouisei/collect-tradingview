//@version=5
indicator("Alpha SuperTrend Signal [identityKa]", overlay=true, max_labels_count=500)

// ==========================================
// 1. USER INPUTS (SETTINGS) - GLOBAL ENGLISH
// ==========================================
grp1 = "âš™ï¸ Smart Engine Settings"
use_auto = input.bool(true, "Auto-Adaptive Sensitivity", group=grp1, tooltip="If enabled, dynamically reduces the multiplier on lower timeframes (like 15m/1h) to prevent lag and catch early reversals.")
manual_atr = input.int(10, "ATR Length", minval=1, group=grp1)
manual_factor = input.float(3.0, "Manual Multiplier", step=0.1, minval=0.1, group=grp1, tooltip="Used only if Auto-Adaptive is disabled.")

grp2 = "ğŸ¨ identityKa Premium Theme"
col_up = input.color(#00ffbb, "Bullish Trend (Neon Green)", group=grp2)
col_dn = input.color(#ff1744, "Bearish Trend (Neon Red)", group=grp2)
paint_bars = input.bool(true, "Paint Bar Colors Based on Trend", group=grp2)

// ==========================================
// 2. AUTO TIMEFRAME SENSITIVITY
// ==========================================
float smart_factor = manual_factor

if use_auto
    if timeframe.isintraday
        if timeframe.multiplier <= 15
            smart_factor := 1.8 // Fast for scalping (15m and below)
        else if timeframe.multiplier <= 60
            smart_factor := 2.2 // Balanced for day trading (1H)
        else
            smart_factor := 2.6 // Standard for swing (4H)
    else
        smart_factor := 3.0 // Long term default (1D and above)

// ==========================================
// 3. SUPERTREND CALCULATION
// ==========================================
[supertrend, direction] = ta.supertrend(smart_factor, manual_atr)

is_up = direction < 0
is_dn = direction > 0
trend_col = is_up ? col_up : col_dn

// ==========================================
// 4. PREMIUM VISUALIZATION
// ==========================================
// Crisp, clean trend line
plot(supertrend, title="Alpha ST Line", color=trend_col, linewidth=2, style=plot.style_linebr)

// Paint bars for institutional look
barcolor(paint_bars ? trend_col : na)

// ==========================================
// 5. KUSURSUZ ETÄ°KET KONUMLANDIRMA (V3 FIX)
// ==========================================
buy_signal = ta.crossunder(direction, 0)
sell_signal = ta.crossover(direction, 0)

// Etiketler artÄ±k doÄŸrudan SuperTrend Ã§izgisinin Ã¼zerinde/altÄ±nda konumlanacak.
// Mum iÄŸnelerinden baÄŸÄ±msÄ±z, temiz bir gÃ¶rÃ¼nÃ¼m saÄŸlar.
if buy_signal
    // Etiketin ucu Ã§izgiye deÄŸer, gÃ¶vdesi aÅŸaÄŸÄ± sarkar (style_label_up)
    label.new(bar_index, supertrend, "BUY", color=color.new(col_up, 85), style=label.style_label_up, textcolor=col_up, size=size.small, yloc=yloc.price)

if sell_signal
    // Etiketin ucu Ã§izgiye deÄŸer, gÃ¶vdesi yukarÄ± sarkar (style_label_down)
    label.new(bar_index, supertrend, "SELL", color=color.new(col_dn, 85), style=label.style_label_down, textcolor=col_dn, size=size.small, yloc=yloc.price)

// ==========================================
// 6. ALERTS
// ==========================================
alertcondition(buy_signal, title="ğŸŸ¢ Alpha BUY", message="identityKa: Trend reversed UP! (Bullish Signal)")
alertcondition(sell_signal, title="ğŸ”´ Alpha SELL", message="identityKa: Trend reversed DOWN! (Bearish Signal)")
