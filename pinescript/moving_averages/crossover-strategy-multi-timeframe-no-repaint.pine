//@version=5
strategy("Crossover Strategy multi timeframe", overlay=true, default_qty_type=strategy.percent_of_equity, default_qty_value=100)

// === INPUTS ===
emaFastLen = input.int(9, title="Fast EMA Length", minval=1)
emaSlowLen = input.int(18, title="Slow EMA Length", minval=1)
slPercent  = input.float(1.5, title="Stop Loss (%)", minval=0.1, step=0.1)
tpPercent  = input.float(3.0, title="Take Profit (%)", minval=0.1, step=0.1)

// === EMA CALCULATIONS ===
emaFast = ta.ema(close, emaFastLen)
emaSlow = ta.ema(close, emaSlowLen)

// === CROSSOVER CONDITIONS ===
bullishCross = ta.crossover(emaFast, emaSlow)   // EMA 9 crosses above EMA 18 → BUY
bearishCross = ta.crossunder(emaFast, emaSlow)  // EMA 9 crosses below EMA 18 → SELL

// === STOP LOSS & TAKE PROFIT ===
longSL  = close * (1 - slPercent / 100)
longTP  = close * (1 + tpPercent / 100)
shortSL = close * (1 + slPercent / 100)
shortTP = close * (1 - tpPercent / 100)

// === ENTRY LOGIC ===
if bullishCross
    strategy.entry("Long", strategy.long)
    strategy.exit("Long Exit", "Long", stop=longSL, limit=longTP)

if bearishCross
    strategy.entry("Short", strategy.short)
    strategy.exit("Short Exit", "Short", stop=shortSL, limit=shortTP)

// === PLOT EMAs ===
plot(emaFast, title="EMA 9", color=color.green, linewidth=2)
plot(emaSlow, title="EMA 18", color=color.red, linewidth=2)

// === PLOT SIGNALS ===
plotshape(bullishCross, title="Buy Signal", location=location.belowbar, style=shape.triangleup, color=color.green, size=size.small, text="BUY")
plotshape(bearishCross, title="Sell Signal", location=location.abovebar, style=shape.triangledown, color=color.red, size=size.small, text="SELL")

// === BACKGROUND COLOR ===
bgcolor(emaFast > emaSlow ? color.new(color.green, 90) : color.new(color.red, 90), title="Trend Background")
