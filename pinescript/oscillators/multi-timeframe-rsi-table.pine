//@version=6
indicator("Multi-Timeframe RSI Table", overlay=true)

// === INPUTS ===
tf1 = input.timeframe("5", "Timeframe 1")
tf2 = input.timeframe("15", "Timeframe 2")
tf3 = input.timeframe("60", "Timeframe 3")
rsiLength = input.int(14, "RSI Length", minval=1)
tablePos = input.string("top_right", "Table Position", options=["top_left", "top_right", "middle_left", "middle_right", "bottom_left", "bottom_right"])
tableWidth = input.int(2, "Table Width", minval=1)
tableHeight = input.int(4, "Table Height", minval=1)

// === RSI CALCULATIONS ===
rsi1 = request.security(syminfo.tickerid, tf1, ta.rsi(close, rsiLength))
rsi2 = request.security(syminfo.tickerid, tf2, ta.rsi(close, rsiLength))
rsi3 = request.security(syminfo.tickerid, tf3, ta.rsi(close, rsiLength))

// === COLOR FUNCTION ===
getColor(val) =>
    val > 60 or val < 40 ? color.red : color.new(color.red, 70)

// === TABLE SETUP ===
var table rsiTable = table.new(tablePos, tableWidth, tableHeight, border_width=1)

// === TABLE UPDATE ===
if bar_index % 1 == 0
    table.cell(rsiTable, 0, 0, "TF", text_color=color.white, bgcolor=color.gray)
    table.cell(rsiTable, 1, 0, "RSI", text_color=color.white, bgcolor=color.gray)

    table.cell(rsiTable, 0, 1, tf1)
    table.cell(rsiTable, 1, 1, str.tostring(rsi1, "#.##"), text_color=getColor(rsi1))

    table.cell(rsiTable, 0, 2, tf2)
    table.cell(rsiTable, 1, 2, str.tostring(rsi2, "#.##"), text_color=getColor(rsi2))

    table.cell(rsiTable, 0, 3, tf3)
    table.cell(rsiTable, 1, 3, str.tostring(rsi3, "#.##"), text_color=getColor(rsi3))
