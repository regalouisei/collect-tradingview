//@version=5
indicator("ThinkOrSwim Style: Williams %R + Bollinger %B", overlay=false, max_labels_count=500)

// -----------------------------------------
// 1. WILLIAMS %R (10) — escala 0 a 100
// -----------------------------------------
lengthW = input.int(10, "Williams %R Length")

wpr_raw = ta.wpr(lengthW)           // -100 a 0
wpr = 100 + wpr_raw                 // reescala a 0–100 como ThinkOrSwim

plot(wpr, color=color.yellow, linewidth=2, title="Williams %R")

// Líneas horizontales estilo TOS
hline(80, "Upper Band", color=color.new(color.yellow, 60))
hline(50, "Midline", color=color.new(color.yellow, 80))
hline(20, "Lower Band", color=color.new(color.yellow, 60))

// -----------------------------------------
// 2. BOLLINGER %B (20, 2.0) — también 0 a 100
// -----------------------------------------
lengthBB = input.int(20, "BB Length")
multBB   = input.float(2.0, "BB StdDev")

basis = ta.sma(close, lengthBB)
dev = multBB * ta.stdev(close, lengthBB)

upper = basis + dev
lower = basis - dev

// Fórmula exacta de TOS para PercentB
percentB = (close - lower) / (upper - lower) * 100

// Color estilo TOS (turquesa)
bbColor = color.rgb(0, 255, 255)

// Plot como columnas
plot(percentB, title="Bollinger %B", style=plot.style_columns, color=bbColor)
