//@version=6
strategy("50 & 200 SMA + RSI Ortalaması Stratejisi (Long Only, Tek İşlem)",
     overlay           = true,
     initial_capital   = 1000,                      // Başlangıç sermayesi: 1000$
     pyramiding        = 0,                         // Aynı anda sadece 1 pozisyon
     margin_long       = 100,
     default_qty_type  = strategy.percent_of_equity,// Pozisyon büyüklüğü: sermayenin yüzdesi
     default_qty_value = 84)                       // %100 sermaye ile pozisyon

//=== Parametreler ===//
smaLenShort  = input.int(50,  "Kısa SMA Periyodu (50)")
smaLenLong   = input.int(200, "Uzun SMA Periyodu (200)")

rsiLen       = input.int(21,  "RSI Periyodu")
rsiMaLen     = input.int(9,   "RSI Hareketli Ortalama Periyodu")

buyRsiMaLvl  = input.float(57.0, "Alış RSI Ort. Eşiği")
sellRsiMaLvl = input.float(57.0, "Satış RSI Ort. Eşiği")

//=== Hareketli Ortalamalar ===//
sma50  = ta.sma(close, smaLenShort)
sma200 = ta.sma(close, smaLenLong)

//=== RSI ve RSI'ın Hareketli Ortalaması ===//
rsiVal   = ta.rsi(close, rsiLen)
rsiMaVal = ta.sma(rsiVal, rsiMaLen)

//=== Pozisyonda mıyız? ===//
inLong = strategy.position_size > 0

//=== Alış Koşulu ===//
// Fiyat 50 SMA ve 200 SMA üzerinde
// RSI'ın hareketli ortalaması > 58
// ve şu anda açık pozisyon yok
longEntryCond = close > sma50 and close > sma200 and rsiMaVal > buyRsiMaLvl and not inLong

//=== Satış Koşulu ===//
// Fiyat 50 SMA altında
// RSI'ın hareketli ortalaması < 50
// ve pozisyonda isek
longExitCond = close < sma50 and rsiMaVal < sellRsiMaLvl and inLong

//=== İşlemler ===//
if longEntryCond
    strategy.entry("Long", strategy.long)

if longExitCond
    strategy.close("Long")

//=== Görselleştirme ===//
plot(sma50,  title = "SMA 50",  linewidth = 2)
plot(sma200, title = "SMA 200", linewidth = 2)
