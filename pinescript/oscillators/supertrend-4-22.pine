//@version=5
strategy("Supertrend (4, 22) Strategy", overlay=true, initial_capital=10000, default_qty_type=strategy.percent_of_equity, default_qty_value=100)

// 1. Inputs
atrPeriod = input.int(4, title="ATR Length", minval=1)
factor = input.float(22.0, title="Factor", minval=0.01, step=0.1)

// 2. Supertrend Calculation
[supertrend, direction] = ta.supertrend(factor, atrPeriod)

// 3. Signal Logic
// Buy when direction changes from positive (red) to negative (green)
buySignal = direction < 0 and direction[1] > 0
// Exit when direction changes from negative (green) to positive (red)
exitSignal = direction > 0 and direction[1] < 0

// 4. Strategy Execution
if (buySignal)
    strategy.entry("Long", strategy.long)

if (exitSignal)
    strategy.close("Long")

// 5. Visuals (Keep the same look as your indicator)
plot(direction < 0 ? supertrend : na, "Up Trend", color = color.green, style = plot.style_linebr, linewidth=2)
plot(direction > 0 ? supertrend : na, "Down Trend", color = color.red, style = plot.style_linebr, linewidth=2)

plotshape(buySignal, title="Buy Signal", location=location.belowbar, color=color.green, style=shape.triangleup, size=size.normal)
plotshape(exitSignal, title="Exit Signal", location=location.abovebar, color=color.red, style=shape.triangledown, size=size.small)
