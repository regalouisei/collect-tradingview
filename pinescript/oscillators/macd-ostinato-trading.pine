//@version=6
indicator(title = 'MACD - Ostinato Trading', shorttitle = 'MACD')

// Getting inputs for first MACD
fast_length = input(title = 'Fast Length', defval = 12)
slow_length = input(title = 'Slow Length', defval = 26)
src = input(title = 'Source', defval = close)
signal_length = input.int(title = 'Signal Smoothing', minval = 1, maxval = 1000, defval = 9)
sma_source = input(title = 'Simple MA (Oscillator)', defval = false)
sma_signal = input(title = 'Simple MA (Signal Line)', defval = false)


// Calculating
fast_ma = sma_source ? ta.sma(src, fast_length) : ta.ema(src, fast_length)
slow_ma = sma_source ? ta.sma(src, slow_length) : ta.ema(src, slow_length)
macd = fast_ma - slow_ma
signal = sma_signal ? ta.sma(macd, signal_length) : ta.ema(macd, signal_length)
hist = macd - signal
macdplot = plot(macd, title = 'MACD', color = macd <= signal ? color.new(#ff5252, 50) : color.new(#4caf50, 50), style = plot.style_line)
signalplot = plot(signal, title = 'Signal', color = ta.change(signal) <= 0 ? color.new(#ff5252, 25) : color.new(#4caf50, 25), style = plot.style_line)


fill(macdplot, signalplot, color = macd > signal ? color.new(#4caf50, 75) : color.new(#ff5252, 75), editable = true)



// Getting inputs for second MACD
fast_length2 = input(title = 'Fast Length2', defval = 50)
slow_length2 = input(title = 'Slow Length2', defval = 100)
src2 = input(title = 'Source2', defval = close)
signal_length2 = input.int(title = 'Signal Smoothing2', minval = 1, maxval = 100, defval = 36)
sma_source2 = input(title = 'Simple MA (Oscillator)2', defval = false)
sma_signal2 = input(title = 'Simple MA (Signal Line)2', defval = false)


// Calculating
fast_ma2 = sma_source2 ? ta.sma(src2, fast_length2) : ta.ema(src2, fast_length2)
slow_ma2 = sma_source2 ? ta.sma(src2, slow_length2) : ta.ema(src2, slow_length2)
macd2 = fast_ma2 - slow_ma2
signal2 = sma_signal2 ? ta.sma(macd2, signal_length2) : ta.ema(macd2, signal_length2)
hist2 = macd2 - signal2
macdplot2 = plot(macd2, title = 'MACD2', color = macd2 <= signal2 ? color.red : color.green, style = plot.style_line)
signalplot2 = plot(signal2, title = 'Signal2', color = ta.change(signal2) <= 0 ? color.red : color.green, style = plot.style_line)


fill(macdplot2, signalplot2, color = macd2 > signal2 ? color.green : color.red, editable = true)

hline(0, '0 Line', linestyle = hline.style_dashed, color = color.new(#5d606b, 0), linewidth = 1)


// Background Coloring Logic
bg_color = macd2 > signal2 ? color.new(color.green, 85) : color.new(color.red, 85)
bgcolor(bg_color, title = 'Continuous Background')
