// This Pine Script® code is subject to the terms of the Mozilla Public License 2.0 at https://mozilla.org/MPL/2.0/
// © The_stopless_trader

//@version=6
indicator("4x Stochastic Combo (v6) - %K only", overlay=false)

// funkcja licząca stoch (%K i %D), ale zwracamy tylko %K do rysowania
f_stoch(len, k_smooth, d_smooth) =>
    hh = ta.highest(high, len)
    ll = ta.lowest(low, len)
    raw = hh != ll ? 100.0 * (close - ll) / (hh - ll) : 0.0
    k = ta.sma(raw, k_smooth)
    d = ta.sma(k, d_smooth)
    [k, d]

[k1, d1] = f_stoch(9, 3, 3)
[k2, d2] = f_stoch(14, 3, 3)
[k3, d3] = f_stoch(40, 4, 4)
[k4, d4] = f_stoch(60, 10, 10)

// rysujemy tylko %K (linie %D nie są pokazywane)
plot(k1, "Stoch %K (9,3,3)",  color=color.red)
plot(k2, "Stoch %K (14,3,3)", color=color.blue)
plot(k3, "Stoch %K (40,4,4)", color=color.green)
plot(k4, "Stoch %K (60,10,10)",color=color.orange)

// poziomy 80 i 20
hline(80, "Overbought 80", color=color.gray, linestyle=hline.style_dotted)
hline(20, "Oversold 20",  color=color.gray, linestyle=hline.style_dotted)

// alerty: wszystkie powyżej 80 lub wszystkie poniżej 20
allAbove = (k1 > 80 and k2 > 80 and k3 > 80 and k4 > 80)
allBelow = (k1 < 20 and k2 < 20 and k3 < 20 and k4 < 20)

alertcondition(allAbove, title="ALL Stoch > 80", message="All 4 Stoch %K are above 80")
alertcondition(allBelow, title="ALL Stoch < 20", message="All 4 Stoch %K are below 20")
