//@version=5
indicator("Ä°ÄŸne + RSI + GÃ¶vde YoÄŸunluÄŸu Stratejisi", overlay=true)

// === Ayarlar ===
rsiPeriod = input.int(14, "RSI Periyodu")
rsiLongLimit = input.float(30.0, "Long iÃ§in RSI alt sÄ±nÄ±rÄ±")
rsiShortLimit = input.float(70.0, "Short iÃ§in RSI Ã¼st sÄ±nÄ±rÄ±")
wickRatioLimit = input.float(0.2, "KÄ±sa iÄŸne oranÄ± eÅŸiÄŸi (0.2 = %20)")

// === Hesaplamalar ===
rsi = ta.rsi(close, rsiPeriod)

body = math.abs(close - open)
upper_wick = high - math.max(close, open)
lower_wick = math.min(close, open) - low
candle_length = high - low

upper_ratio = candle_length != 0 ? upper_wick / candle_length : na
lower_ratio = candle_length != 0 ? lower_wick / candle_length : na

prev_candle_size = math.abs(high[1] - low[1])
curr_candle_size = math.abs(high - low)

// === 1ï¸âƒ£ Ä°ÄNE STRATEJÄ°SÄ° ===
longWickCond  = (lower_ratio > 0.5) and (close > open) and (rsi < rsiLongLimit)
shortWickCond = (upper_ratio > 0.5) and (close < open) and (rsi > rsiShortLimit)

// === 2ï¸âƒ£ DOLU GÃ–VDELÄ° STRATEJÄ° ===
fullBodyRed = (rsi > rsiShortLimit) and (close < open) and (upper_ratio < wickRatioLimit) and (lower_ratio < wickRatioLimit) and (curr_candle_size > prev_candle_size)
fullBodyGreen = (rsi < rsiLongLimit) and (close > open) and (upper_ratio < wickRatioLimit) and (lower_ratio < wickRatioLimit) and (curr_candle_size > prev_candle_size)

// === 3ï¸âƒ£ SÄ°NYAL KOÅULLARI ===
longCondition  = longWickCond or fullBodyGreen
shortCondition = shortWickCond or fullBodyRed

// === GRAFÄ°K ===
barcolor(longWickCond ? color.new(color.green, 0) : shortWickCond ? color.new(color.red, 0) : na)
barcolor(fullBodyGreen ? color.new(color.new(#76e27a, 60), 0) : fullBodyRed ? color.new(color.new(#f83f3f, 60), 0) : na)

// === ETÄ°KETLER ===
if (longCondition)
    label.new(bar_index, low, "ğŸŸ¢ L+ ", 
              style=label.style_label_up, color=color.new(#f7faf7, 0), textcolor=color.rgb(6, 23, 182))

if (shortCondition)
    label.new(bar_index, high, "ğŸ”´ S", 
              style=label.style_label_down, color=color.new(#fdfcfc, 0), textcolor=color.rgb(0, 14, 13))

// === ALARM KOÅULLARI ===
alertcondition(longCondition,  title="Long Sinyali",  message="LONG sinyali (iÄŸne veya dolu gÃ¶vdeli yeÅŸil mum)")
alertcondition(shortCondition, title="Short Sinyali", message="SHORT sinyali (iÄŸne veya dolu gÃ¶vdeli kÄ±rmÄ±zÄ± mum)")

// === RSI GÃ–STERÄ°MÄ° ===
plot(rsi, title="RSI", color=color.new(color.orange, 0))
hline(rsiLongLimit, "RSI Long EÅŸiÄŸi", color=color.new(color.green, 60))
hline(rsiShortLimit, "RSI Short EÅŸiÄŸi", color=color.new(color.red, 60))
