//@version=6
indicator(title="Auto Timeframe RSI", shorttitle="Auto RSI", overlay=false)

// === AUTO RSI LENGTH BY TIMEFRAME ===
rsiLength =
     timeframe.period == "D"   or
     timeframe.period == "240" or
     timeframe.period == "60"  ? 30 :
     timeframe.period == "5"   ? 7  :
     30

src = close

change = ta.change(src)
up = ta.rma(math.max(change, 0), rsiLength)
down = ta.rma(-math.min(change, 0), rsiLength)
rsi = down == 0 ? 100 : up == 0 ? 0 : 100 - (100 / (1 + up / down))

plot(rsi, title="RSI", color=#7E57C2, linewidth=2)

hline(70, "Overbought", color=color.red)
hline(50, "Midline", color=color.new(color.gray, 50))
hline(30, "Oversold", color=color.green)

bgcolor(rsi > 70 ? color.new(color.red, 90) :
       rsi < 30 ? color.new(color.green, 90) : na)
