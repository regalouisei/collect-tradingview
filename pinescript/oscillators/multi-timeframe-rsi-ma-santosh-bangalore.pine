// This Pine Script® code is subject to the terms of the Mozilla Public License 2.0 at https://mozilla.org/MPL/2.0/
// © Santoshramamdas

//@version=5
indicator("Multi-Timeframe RSI + MAs", shorttitle="MTF RSI + MAs", overlay=false)

// --- Input Parameters ---
rsiLength = input.int(14, "RSI Length")
tf5_input = input.string("5", "5-min Timeframe", options=["1", "3", "5", "15", "30", "60"])
tf15_input = input.string("15", "15-min Timeframe", options=["1", "3", "5", "15", "30", "60"])

// Moving Average Inputs
maLength5 = input.int(9, "MA Length for 5-min RSI")
maLength15 = input.int(14, "MA Length for 15-min RSI") // Added separate MA length
maType = input.string("SMA", "MA Type (Both RSIs)", options=["SMA", "EMA"])

// --- Retrieve RSI data from different timeframes ---
rsi_5min = request.security(syminfo.tickerid, tf5_input, ta.rsi(close, rsiLength))
rsi_15min = request.security(syminfo.tickerid, tf15_input, ta.rsi(close, rsiLength))

// --- Function to calculate MA (SMA or EMA) ---
getMA(source, length, type) =>
    if type == "SMA"
        ta.sma(source, length)
    else
        ta.ema(source, length)

// --- Calculate Moving Averages on RSIs ---
ma_5min_rsi = getMA(rsi_5min, maLength5, maType)
ma_15min_rsi = getMA(rsi_15min, maLength15, maType)

// --- Plot the RSIs and MAs ---
plot(rsi_5min, title="5-min RSI", color=color.new(color.blue, 0), linewidth=2)
plot(rsi_15min, title="15-min RSI", color=color.new(color.orange, 0), linewidth=2)
plot(ma_5min_rsi, title="MA of 5-min RSI", color=color.new(color.purple, 0), linewidth=1, style=plot.style_line)
plot(ma_15min_rsi, title="MA of 15-min RSI", color=color.new(color.red, 0), linewidth=1, style=plot.style_line)


// --- Plot Overbought/Oversold levels and Middle line ---
hline(70, "Overbought", color=color.red, linestyle=hline.style_dotted, linewidth=1)
hline(50, "Middle Line", color=color.gray, linestyle=hline.style_dotted, linewidth=1)
hline(30, "Oversold", color=color.green, linestyle=hline.style_dotted, linewidth=1)
