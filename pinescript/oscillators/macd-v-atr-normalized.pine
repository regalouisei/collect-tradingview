//@version=5
indicator("ATR-Normalized MACD x100", shorttitle="ATR MACD x100", overlay=false)

// Inputs
fastLen   = input.int(12,  "Fast EMA Length")
slowLen   = input.int(26,  "Slow EMA Length")
signalLen = input.int(9,   "Signal Length")
atrLen    = input.int(26,  "ATR Length")

// Core calculations
emaFast = ta.ema(close, fastLen)
emaSlow = ta.ema(close, slowLen)
atrVal  = ta.atr(atrLen)

// ATR-normalized MACD scaled by 100
macd_adj = ((emaFast - emaSlow) / atrVal) * 100

// Signal line and histogram
signal = ta.ema(macd_adj, signalLen)
hist   = macd_adj - signal

// Plotting
plot(macd_adj, title="ATR-Normalized MACD x100", color=color.blue, linewidth=2)
plot(signal,   title="Signal Line", color=color.orange, linewidth=2)
plot(hist,     title="Histogram", style=plot.style_columns,
     color = hist >= 0 ? color.new(color.green, 0) : color.new(color.red, 0))

hline(0, "Zero Line", color=color.gray)
