// This Pine ScriptÂ® code is subject to the terms of the Mozilla Public License 2.0 at https://mozilla.org/MPL/2.0/
// Â© SignalLynx

//@version=5
// Super-AO Engine - Market Sentiment Ribbon - 11-29-25 Release


// ============================================================================================================
//     SIGNAL LYNX - SUPER-AO MARKET SENTIMENT RIBBON
// ============================================================================================================
//
//     INTRODUCTION:
//     This is the "Visual Health Check" tool for the Super-AO Ecosystem.
//     While the Strategy script handles the math, this script handles the "Vibe."
//    
//     WHAT IT DOES:
//     It calculates the underlying strength of the trend by measuring the distance (spread) 
//     between price, the SuperTrend, and the Awesome Oscillator. 
//    
//     It outputs a simple, color-coded Ribbon at the top of your chart.
//    
//     HOW TO READ THE RIBBON:
//     - ðŸŸ© LIME/GREEN: Strong Bullish Momentum (Healthy Long Environment)
//     - ðŸŸ¨ OLIVE/YELLOW: Weakening Bullish Momentum (Caution/Take Profit)
//     - â¬œ GRAY: Neutral / Chop Zone (Stay Out)
//     - ðŸŸ§ ORANGE: Weakening Bearish Momentum (Caution/Take Profit)
//     - ðŸŸ¥ RED: Strong Bearish Momentum (Healthy Short Environment)
//
//     USAGE:
//     Use this as a confirmation tool. If your Strategy gives a Buy Signal, but this ribbon 
//     is Gray or Orange, you might want to wait for better conditions.
//
//     --------------------------------------------------------------------------------------------------------
//     Signal Lynx
//     Free Scripts supporting Automation for the Night-Shift Nation ðŸŒ™
//    
//     We are providing this code open source to support the night shift nation. 
//    
//     If you are looking to automate your strategies, please take a look at SignalLynx in your search:
//     (www.signallynx.com)
//     --------------------------------------------------------------------------------------------------------


indicator('Super-AO Engine - Sentiment Ribbon - 11-29-25', shorttitle='SAO - Sentiment Ribbon', overlay=true)

////////////////////////////////////////////////////////////////
//* Inputs                                                   *//
////////////////////////////////////////////////////////////////

var AOInputs = "Awesome Oscilator Inputs"
AOfastLength = input.int(title='AO Fast Length', defval=14, group=AOInputs)
AOslowLength = input.int(title='AO Slow Length', defval=420, group=AOInputs) // Aligned with Strategy Default
AOSmoothInput = input.int(title='AO Smoother length', defval=21, group=AOInputs)

var STInputs = "Super Trend Inputs"
STPeriods = input.int(title='ST ATR Period', defval=14, group=STInputs)
STMultiplier = input.float(title='ST ATR Multiplier', defval=7.0, group=STInputs) // Aligned with Strategy Default
STSmoothLen = input.int(title='ST Smoothing Length', defval=14, group=STInputs) 

// Visual Placement
RibbonLoc = input.string("Top", "Ribbon Location", options=["Top", "Bottom"])
LocSelection = RibbonLoc == "Top" ? location.top : location.bottom


////////////////////////////////////////////////////////////////
//* Calculations                                             *//
////////////////////////////////////////////////////////////////

// --- Awesome Oscillator Logic ---
ao = ta.sma(close, AOfastLength) - ta.sma(close, AOslowLength)
aoSmooth = ta.ema(ao, AOSmoothInput)
AORising = ta.rising(ao, AOSmoothInput) ? 1 : -1

// --- SuperTrend Logic ---
STsrc = close
STatr = ta.atr(STPeriods)
STup = STsrc - STMultiplier * STatr
STup1 = nz(STup[1], STup)
STup := close[1] > STup1 ? math.max(STup, STup1) : STup
STdn = STsrc + STMultiplier * STatr
STdn1 = nz(STdn[1], STdn)
STdn := close[1] < STdn1 ? math.min(STdn, STdn1) : STdn

STtrend = 1
STtrend := nz(STtrend[1], STtrend)
STtrend := STtrend == -1 and close > STdn1 ? 1 : STtrend == 1 and close < STup1 ? -1 : STtrend

// --- Smoothing for Sentiment Calculation ---
STdnsmooth = ta.sma(STdn, STSmoothLen)
STupsmooth = ta.sma(STup, STSmoothLen)

// --- Sentiment Math ---
// Calculate the percentage distance of AO Spread relative to price
SentimentBandAO = ((ta.sma(close, AOfastLength) - ta.sma(close, AOslowLength)) / close) * 100

// Determine if the smoothed SuperTrend is rising or falling
STUpRise4Sentiment = ta.rising(STupsmooth, STSmoothLen) ? 1 : -1

// Calculate the percentage distance of Price vs SuperTrend
STSentiment = STUpRise4Sentiment == 1 ? ((close - STupsmooth) / close) * 100 : 
              STUpRise4Sentiment == -1 ? ((STdnsmooth - close) / close) * -100 : 0

// Combine the two metrics into a single Sentiment Score
SentimentBand = STSentiment != 0 ? (SentimentBandAO + STSentiment) / 2 : SentimentBandAO


////////////////////////////////////////////////////////////////
//* Visualization                                            *//
////////////////////////////////////////////////////////////////

// Define Color thresholds based on Sentiment Score
// These levels help visualize the intensity of the trend
SentimentBandColor = SentimentBand <= -37 ? color.new(color.red, 0) :                // Extreme Bearish
                     SentimentBand > -37 and SentimentBand <= -22 ? color.new(color.orange, 0) : // Moderate Bearish
                     SentimentBand > -22 and SentimentBand <= -6 ? color.new(color.yellow, 0) :  // Weak Bearish/Warning
                     SentimentBand > -6 and SentimentBand <= 6 ? color.new(color.gray, 50) :     // Neutral / Chop
                     SentimentBand > 6 and SentimentBand <= 22 ? color.new(color.olive, 0) :     // Weak Bullish/Warning
                     SentimentBand > 22 and SentimentBand < 37 ? color.new(color.green, 0) :     // Moderate Bullish
                     SentimentBand >= 37 ? color.new(color.lime, 0) : color.black                // Extreme Bullish

// Plot the Ribbon
plotshape(SentimentBand, style=shape.square, color=SentimentBandColor, location=LocSelection, size=size.tiny, title='Super-AO Market Sentiment')

///////////////////////////////////
//======[ EOF - Done Baby ]======//
///////////////////////////////////
