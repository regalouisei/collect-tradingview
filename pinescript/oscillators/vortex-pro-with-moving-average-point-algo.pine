// This Pine Scriptâ„¢ code is subject to the terms of the Mozilla Public License 2.0 at https://mozilla.org/MPL/2.0/

//@version=6
indicator("Vortex Pro with Moving average [point algo]", overlay=false)

// Inputs
length = input.int(14, "Vortex Period", minval=2)
ma_length = input.int(9, "MA Period", minval=1)
ma_type = input.string("EMA", "MA Type", options=["EMA", "SMA", "HMA", "WMA"])

// Calculate True Range and Directional Movement
tr = ta.tr
vm_plus = math.abs(high - low[1])
vm_minus = math.abs(low - high[1])

// Calculate Vortex Indicator components
vi_plus = math.sum(vm_plus, length) / math.sum(tr, length)
vi_minus = math.sum(vm_minus, length) / math.sum(tr, length)

// Calculate Vortex Pro (scaled by 10)
vortex_pro = (vi_plus - vi_minus) * 10

// Calculate selected Moving Average
vortex_pro_ma = switch ma_type
    "EMA" => ta.ema(vortex_pro, ma_length)
    "SMA" => ta.sma(vortex_pro, ma_length)
    "HMA" => ta.hma(vortex_pro, ma_length)
    "WMA" => ta.wma(vortex_pro, ma_length)
    => na

// Plot Vortex Pro line
vortex_plot = plot(vortex_pro, title="Vortex Pro", color=color.blue, linewidth=2)

// Plot selected Moving Average
plot(vortex_pro_ma, title="Vortex Pro MA", color=color.orange, linewidth=1)

// Plot zero line as plot (not hline) to use with fill
zero_line = plot(0, "Zero Line", color=color.gray, linewidth=1, style=plot.style_line)

// Fill area between Vortex Pro line and zero line
fill(vortex_plot, zero_line, color=vortex_pro > 0 ? color.new(color.green, 80) : color.new(color.red, 80), title="Vortex Zone Fill")
