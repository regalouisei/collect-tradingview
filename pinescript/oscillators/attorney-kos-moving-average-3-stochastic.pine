// This Pine Script™ code is subject to the terms of the Mozilla Public License 2.0 at https://mozilla.org/MPL/2.0/
// 

//@version=6
indicator("go_st_40 복사본")

//무료쓰면 4분차트, 3일차트를 사용 못 한다. 1분봉 쓰면서 Multiply에 4를 쓰면 왜곡이 있지만 4분일 때의 이평선과 스토캐스틱을 쓸 수 있다.

length = input(1, 'Multiply')

//이평선 정보

ma3 = ta.sma(close, length*3)
ma5 = ta.sma(close, length*5)
ma10 = ta.sma(close, length*10)
ma20 = ta.sma(close, length*20)
ma40 = ta.sma(close, length*40)
ma80 = ta.sma(close, length*80)
ma160 = ta.sma(close, length*160)
ma312 = ta.sma(close, length*312)
ma624 = ta.sma(close, length*624)

//sma plot

plot(ma3 , 'ma3', color = #ff0000 , force_overlay = true, linewidth = 1, linestyle = plot.linestyle_dashed)
plot(ma5 , 'ma5' , color = #00ff00 , force_overlay = true, linewidth = 1)
plot(ma10 , 'ma10' , color = #d900ff , force_overlay = true, linewidth = 1)
plot(ma20 , 'ma20' , color = color.aqua , force_overlay = true, linewidth = 1)
plot(ma40 , 'ma60' , color = #ff0000 , force_overlay = true, linewidth = 1)
plot(ma80 , 'ma120' , color = #00ff00 , force_overlay = true, linewidth = 1)
plot(ma160 , 'ma240' , color = #d900ff , force_overlay = true, linewidth = 1)
plot(ma312 , 'ma312' , color = color.aqua , force_overlay = true, linewidth = 1)
plot(ma624 , 'mma624', color = #ff0000 , force_overlay = true, linewidth = 1)
// bgcolor(ma3 > ma5 and ma5 > ma10 and ma10 > ma20 and ma20 > ma40 and ma40 > ma80 and ma80 > ma160 and ma160 > ma312 and ma312 > ma624 ? color.rgb(0, 255, 0, 50) : na, force_overlay = true)
// bgcolor(ma3 < ma5 and ma5 < ma10 and ma10 < ma20 and ma20 < ma40 and ma40 < ma80 and ma80 < ma160 and ma160 < ma312 and ma312 < ma624 ? color.rgb(255, 0, 0, 50) : na, force_overlay = true)

// 스토캐스틱 정보

k_5 = ta.sma(ta.stoch(close, high, low, 5*length), 3*length)
d_5 = ta.sma(k_5, 3*length)
k_10 = ta.sma(ta.stoch(close, high, low,10*length), 5*length)
d_10 = ta.sma(k_10, 5*length)
k_20 = ta.sma(ta.stoch(close, high, low,20*length), 10*length)
d_20 = ta.sma(k_20, 10*length)

//stochasitc_plot 
//k표시, d표시, k와 d크로스 표시, 
//과매수과매도표시선(종합주가지수와 개별종목, 진입과 종료에 쓰는 과매도 과매수를 다르게 쓴다고 책에 나왔다. 책 그대로 적용하려면 참고.), 
//fill낄끔하게 하기 위한 임시선
//과매수과매도 강조
K_5_plot=plot(k_5, title="%k_5", color = #00ff00 )
plot(d_5, title="%d_5", color = #00ff00)
plot(ta.cross(k_5, d_5) ? d_5 : na, title = "k_5cross", color = d_5 - k_5 > 0 ? color.red : color.blue, style = plot.style_circles, linewidth = 2)
h80=plot(80, title= "hline_80",color=color.new(#00ff01,50))
h70=plot(70, title= "hline_70",color=color.new(color.purple, 10))
h50=plot(50, title= "hline_50",color=color.new(#00ff01,50))
h30=plot(30, title= "hline_30",color=color.new(color.purple, 10))
h20=plot(20, title= "hline_20",color=color.new(#00ff01,50))
plot_5k_80= plot(k_5> 80 ? k_5: 80, title="k_20 > 80 plot", color=na)
plot_5k_20= plot(k_5 < 20 ? k_5: 20, title="k_20 < 20 plot", color=na)
fill(plot_5k_80, h80, k_5 > 80 ? color.new(color.green,60): na, title= "k_5 > 80")
fill(plot_5k_20, h20, k_5 < 20 ? color.new(color.green,60): na, title= "k_5 < 20")

k_10_plot=plot(k_10 + 100 , title="%k_10", color = #d900ff )
plot(d_10 + 100, title="%d_10", color = #d900ff )
plot(ta.cross(k_10, d_10) ? d_10 + 100 : na, title = "k_10cross", color = d_10 - k_10 > 0 ? color.red : color.blue , style = plot.style_circles, linewidth = 2)
h180=plot(180, title= "hline_180",color=color.new(#00ff01,50))
h170=plot(170, title= "hline_170",color=color.new(color.purple, 10))
h150=plot(150, title= "hline_150",color=color.new(#00ff01,50))
h130=plot(130, title= "hline_130",color=color.new(color.purple, 10))
h120=plot(120, title= "hline_120",color=color.new(#00ff01,50))
plot_10k_80= plot(k_10 + 100 > 180 ? k_10 + 100: 180, title="k_10 > 180 plot", color=na)
plot_10k_20= plot(k_10 + 100 < 120 ? k_10 + 100: 120, title="k_10 < 120 plot", color=na)
fill(plot_10k_80, h180, k_10 > 80 ? color.new(color.purple,60): na, title= "k_10 > 80")
fill(plot_10k_20, h120, k_10 < 20 ? color.new(color.purple,60): na, title= "k_10 < 20")

k_20_plot=plot(k_20 + 200 , title="%k_20", color = color.aqua )
plot(d_20 + 200, title="%d_20", color = color.aqua)
plot(ta.cross(k_20, d_20) ? d_20 + 200 : na, title = "k_20cross", color = d_20 - k_20 > 0 ? color.orange :  color.green, style = plot.style_circles, linewidth = 2)
h280=plot(280, title= "hline_280",color=color.new(#00ff01,50))
h270=plot(270, title= "hline_270",color=color.new(color.purple, 10))
h250=plot(250, title= "hline_250",color=color.new(#00ff01,50))
h230=plot(230, title= "hline_230",color=color.new(color.purple, 10))
h220=plot(220, title= "hline_220",color=color.new(#00ff01,50))
plot_20k_80= plot(k_20 + 200 > 280 ? k_20 + 200: 280, title="k_20 > 280 plot", color=na)
plot_20k_20= plot(k_20 + 200 < 220 ? k_20 + 200: 220, title="k_20 < 220 plot", color=na)
fill(plot_20k_80, h280, k_20 > 80 ? color.new(color.aqua,60): na, title= "k_20 > 80")
fill(plot_20k_20, h220, k_20 < 20 ? color.new(color.aqua,60): na, title= "k_20 < 20")
