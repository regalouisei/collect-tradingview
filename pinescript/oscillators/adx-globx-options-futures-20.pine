//@version=6
indicator('ADX Globx Options & Futures', shorttitle = 'ADX Globx O&F', overlay = false)

// === Parámetros (IQ Option: 34) ===
adxLen = input.int(34, 'ADX Length')
diLen = input.int(34, 'DI Length')
diSmooth = input.string('EMA', 'DI Smoothing Type', options = ['EMA', 'Wilder'])
adxSmooth = input.string('EMA', 'ADX Smoothing Type', options = ['EMA', 'Wilder'])
showLvls = input.bool(true, 'Mostrar niveles 20 / 25')

// === Helper de suavizado ===
f_smooth(src, len, method) =>
    method == 'EMA' ? ta.ema(src, len) : ta.rma(src, len)

// === +DI / -DI (suavizado seleccionable; por defecto EMA) ===
up = ta.change(high)
down = -ta.change(low)
plusDM = na(up) ? na : up > down and up > 0 ? up : 0
minusDM = na(down) ? na : down > up and down > 0 ? down : 0

tr = ta.tr(true)
trSm = f_smooth(tr, diLen, diSmooth)
pdmSm = f_smooth(plusDM, diLen, diSmooth)
mdmSm = f_smooth(minusDM, diLen, diSmooth)

plusDI = 100 * pdmSm / trSm
minusDI = 100 * mdmSm / trSm
den = plusDI + minusDI
dx = den == 0 ? 0 : 100 * math.abs(plusDI - minusDI) / den

// === ADX (por defecto EMA para igualar IQ Option) ===
adx = f_smooth(dx, adxLen, adxSmooth)

// === Plots (estilo IQ Option) ===
plot(adx, title = 'ADX', color = color.white, linewidth = 1)
plot(plusDI, title = '+DI', color = color.rgb(0, 0, 140), linewidth = 1)
plot(minusDI, title = '-DI', color = color.rgb(140, 0, 0), linewidth = 1)

// === Niveles guía 20/25 ===
h20 = hline(20, '20', color = color.new(color.gray, 80), linestyle = hline.style_dotted)
h25 = hline(25, '25', color = color.new(color.gray, 70), linestyle = hline.style_dashed)
