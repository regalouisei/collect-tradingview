//@version=6
indicator("KD-NewAuto Trade", overlay=true)

// ──────────────── INPUTS ───────────────
fastLength = input.int(10, "Fast EMA Length")
slowLength = input.int(20, "Slow EMA Length")
rsiLength  = input.int(14, "RSI Length")
adxLength  = input.int(14, "ADX Length")
adxSmooth  = input.int(14, "ADX Smooth")
adxMin     = input.int(25, "ADX Min")
adxFilter  = input.bool(true, "Enable ADX Filter")
rsiBuyLvl  = input.int(55, "RSI Buy Level")
rsiSellLvl = input.int(45, "RSI Sell Level")

// ──────────────── CALCULATIONS ───────────────
emaFast = ta.ema(close, fastLength)
emaSlow = ta.ema(close, slowLength)
rsi = ta.rsi(close, rsiLength)
[plusDI, minusDI, adx] = ta.dmi(adxLength, adxSmooth)

// ──────────────── CONDITIONS ───────────────
bullishCross = ta.crossover(emaFast, emaSlow)
bearishCross = ta.crossunder(emaFast, emaSlow)
rsiBull = rsi > rsiBuyLvl
rsiBear = rsi < rsiSellLvl
trendStrong = not adxFilter or (adx > adxMin)

longCond = bullishCross and rsiBull and trendStrong
shortCond = bearishCross and rsiBear and trendStrong

// ──────────────── PLOTTING ───────────────
plot(emaFast, color=color.new(color.green, 0), linewidth=2, title="EMA 10")
plot(emaSlow, color=color.new(color.orange, 0), linewidth=2, title="EMA 20")

plotshape(longCond, title="Buy Signal", location=location.belowbar,
     color=color.new(color.green, 0), style=shape.triangleup, size=size.large, text="BUY")

plotshape(shortCond, title="Sell Signal", location=location.abovebar,
     color=color.new(color.red, 0), style=shape.triangledown, size=size.large, text="SELL")

// ──────────────── ALERTS ───────────────
alertcondition(longCond, title="BUY ALERT",
     message="BUY: EMA 10 crossed above EMA 20 with RSI & ADX confirmation.")
alertcondition(shortCond, title="SELL ALERT",
     message="SELL: EMA 10 crossed below EMA 20 with RSI & ADX confirmation.")

// ──────────────── BACKGROUND ───────────────
bgcolor(longCond ? color.new(color.green, 85) : shortCond ? color.new(color.red, 85) : na)
