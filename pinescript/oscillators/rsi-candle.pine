// This Pine ScriptÂ® code is subject to the terms of the Mozilla Public License 2.0 at https://mozilla.org/MPL/2.0/
// Â© BossOfDolphinGang_
//
// ADDITIONAL RESTRICTIONS:
// - ê°œì¸ í•™ìŠµ ë° ì—°êµ¬ ëª©ì ìœ¼ë¡œë§Œ ì‚¬ìš© ê°€ëŠ¥
// - ìƒì—…ì  ì´ìš©, íŒë§¤ ê¸ˆì§€
// - ìƒì—…ì  ëª©ì ìœ¼ë¡œ ë¬´ë‹¨ ì‚¬ìš© ì‹œ ì €ìž‘ê¶Œë²•ì— ë”°ë¼ ë²•ì  ì±…ìž„ì„ ì§ˆ ìˆ˜ ìžˆìŠµë‹ˆë‹¤.
// - ê°œë°œìž : ëŒê³ ëž˜ë§¤ë§¤ë‹¨
// - ë¬¸ì˜: https://t.me/Boss_DolphinGang

//@version=6
indicator("ðŸ¬RSI_Candle", overlay=false, shorttitle="ðŸ¬RSI_C", format=format.price, precision=2, timeframe = "", timeframe_gaps = true)

//-----
group_rc = "RSI Candle ì„¤ì •"
rc_len = input.int(14, 'RSI ê¸¸ì´', minval = 1, tooltip = 'RSIë¥¼ ê³„ì‚°í•  ë•Œ ì‚¬ìš©í•˜ëŠ” ê¸°ê°„ ê¸¸ì´ìž…ë‹ˆë‹¤.\nê¸°ë³¸ê°’ì€ 14ì´ë©°, ê¸°ê°„ì´ ì§§ì„ìˆ˜ë¡ ë¯¼ê°í•˜ê²Œ ë°˜ì‘í•©ë‹ˆë‹¤.', group = group_rc)
inline_rc_candle = 'rc ìº”ë“¤'
col_rc_candle_up = input.color(#6bd2f4, 'ìº”ë“¤ ìƒ‰ìƒ', inline = inline_rc_candle, group = group_rc)
col_rc_candle_dn = input.color(#ff6b6b, '', inline = inline_rc_candle, group = group_rc)

rc_open = ta.rsi(open, rc_len)
rc_high = ta.rsi(high, rc_len)
rc_low = ta.rsi(low, rc_len)
rc_close = ta.rsi(close, rc_len)

col_candle = rc_close >= rc_open ? col_rc_candle_up : col_rc_candle_dn
plotcandle(rc_open, rc_high, rc_low, rc_close, 'RSI_Candle', color = col_candle, wickcolor = col_candle, bordercolor = col_candle, editable = false)

//-----
group_line = "ê¸°ì¤€ ë¼ì¸ ì„¤ì •"
inline_rc_upper = 'rc ê³¼ë§¤ìˆ˜'
show_rc_upper = input.bool(true, 'RSI ê³¼ë§¤ìˆ˜ ë¼ì¸', inline = inline_rc_upper, group = group_line)
col_rc_upper = input.color(#787B86, '', inline = inline_rc_upper, group = group_line)
rc_upper = input.int(70, '', minval=51, maxval = 99, step=1, tooltip='RSI ê³¼ë§¤ìˆ˜ë¥¼ íŒë‹¨í•˜ê¸° ìœ„í•œ ê¸°ì¤€ê°’ìž…ë‹ˆë‹¤.\nì¼ë°˜ì ìœ¼ë¡œ 70ìœ¼ë¡œ ì„¤ì •í•©ë‹ˆë‹¤.', inline = inline_rc_upper, group = group_line)
inline_rc_middle = 'rc ë¯¸ë“¤ ë¼ì¸'
show_rc_middle = input.bool(true, 'RSI ë¯¸ë“¤ ë¼ì¸', inline = inline_rc_middle, group = group_line)
col_rc_middle = input.color(color.new(#787B86,50), '', inline = inline_rc_middle, group = group_line)
inline_rc_lower = 'rc ê³¼ë§¤ë„'
show_rc_lower = input.bool(true, 'RSI ê³¼ë§¤ë„ ë¼ì¸', inline = inline_rc_lower, group = group_line)
col_rc_lower = input.color(#787B86, '', inline = inline_rc_lower, group = group_line)
rc_lower = input.int(30, '', minval=1, maxval = 49, step=1, tooltip='RSI ê³¼ë§¤ë„ë¥¼ íŒë‹¨í•˜ê¸° ìœ„í•œ ê¸°ì¤€ê°’ìž…ë‹ˆë‹¤.\nì¼ë°˜ì ìœ¼ë¡œ 30ìœ¼ë¡œ ì„¤ì •í•©ë‹ˆë‹¤.', inline = inline_rc_lower, group = group_line)

hline(show_rc_upper ? rc_upper : na, 'RSI ê³¼ë§¤ìˆ˜ ë¼ì¸', color = col_rc_upper, editable = false)
hline(show_rc_middle ? 50 : na, 'RSI ì¤‘ì‹¬ ë¼ì¸', color = col_rc_middle, editable = false)
hline(show_rc_lower ? rc_lower : na, 'RSI ê³¼ë§¤ë„ ë¼ì¸', color = col_rc_lower, editable = false)

//-----
group_overzone = 'ê³¼ë§¤ìˆ˜/ê³¼ë§¤ë„ ì„¤ì •'
show_overzone = input.bool(true, 'ê³¼ë§¤ìˆ˜/ê³¼ë§¤ë„ ìƒ‰ìƒ ë³´ì´ê¸°', 'RSIê°€ ê³¼ë§¤ìˆ˜ ë˜ëŠ” ê³¼ë§¤ë„ êµ¬ê°„ì— ìžˆì„ ë•Œ ë°°ê²½ìƒ‰ì„ í‘œì‹œí• ì§€ ì—¬ë¶€ë¥¼ ì„¤ì •í•©ë‹ˆë‹¤.', group = group_overzone)
inline_oz_col = 'oz ìƒ‰ìƒ'
col_overbought = input.color(#ffd600, 'ê³¼ë§¤ìˆ˜', inline = inline_oz_col, group = group_overzone)
col_oversold = input.color(#00ffaa, 'ê³¼ë§¤ë„', inline = inline_oz_col, group = group_overzone)
transp_max = input.int(90, 'ë°°ê²½ìƒ‰ ìµœëŒ€ íˆ¬ëª…ë„', minval = 50, maxval = 99, tooltip = 'ë°°ê²½ìƒ‰ì˜ ìµœëŒ€ íˆ¬ëª…ë„ë¥¼ ì„¤ì •í•©ë‹ˆë‹¤.\nê°’ì´ ë†’ì„ìˆ˜ë¡ ë” íˆ¬ëª…í•´ì§‘ë‹ˆë‹¤.', group = group_overzone)
transp_range = input.int(50, 'íˆ¬ëª…ë„ ë³€í™” í­', minval = 1, maxval = 50, tooltip = 'íˆ¬ëª…ë„ ë³€í™” í­ìž…ë‹ˆë‹¤.\nê³¼ë§¤ìˆ˜/ê³¼ë§¤ë„ ê°•ë„ì— ë”°ë¼ ìƒ‰ì˜ ì§„í•˜ê¸°ê°€ ì–¼ë§ˆë‚˜ ë‹¬ë¼ì§ˆì§€ ì¡°ì ˆí•©ë‹ˆë‹¤.', group = group_overzone)

rc_max = math.max(rc_open, rc_high, rc_low, rc_close)
rc_min = math.min(rc_open, rc_high, rc_low, rc_close)

ratio_overbought = math.min(math.max((rc_max - rc_upper) / (100 - rc_upper), 0), 1)
ratio_oversold = math.min(math.max(rc_min / rc_lower, 0), 1)

bgcolor(show_overzone ? 
     rc_max > rc_upper ? color.new(col_overbought, transp_max - ratio_overbought * transp_range) : 
     rc_min < rc_lower ? color.new(col_oversold, (transp_max - transp_range) + ratio_oversold * transp_range) : 
     na : na, editable=false)
