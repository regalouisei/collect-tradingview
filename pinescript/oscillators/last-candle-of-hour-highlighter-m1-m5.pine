//@version=6
indicator("Last Candle of Hour (M1 + M5) â€“ Bar Color", overlay=true)

// Detect timeframe
is_m1 = timeframe.isminutes and timeframe.multiplier == 1
is_m5 = timeframe.isminutes and timeframe.multiplier == 5
currMinute = minute(time)

// Identify last candle of each hour
isLastCandle = (is_m1 and currMinute == 59) or (is_m5 and currMinute == 55)

// Inputs
useBullBear = input.bool(false, "Color by Bull / Bear (if off uses single color)")
singleColor = input.color(color.new(color.yellow, 0), "Highlight color (single)")
bullColor   = input.color(color.new(color.green, 0), "Bullish color")
bearColor   = input.color(color.new(color.red, 0), "Bearish color")

// Choose color
barColor = useBullBear ? (close > open ? bullColor : bearColor) : singleColor

// Color only the last candle of the hour
barcolor(isLastCandle ? barColor : na)
