// This Pine Script® code is subject to the terms of the Mozilla Public License 2.0 at https://mozilla.org/MPL/2.0/
// © QuantLapse

//@version=6
indicator("Hyper Strength Index (HSI) | QuantLapse", shorttitle = "HSI | QuantLapse", overlay = false)
import TradingView/ta/10

overbought = input.int(75, "Overbought Threshold", inline = "valuation", group = "~~~~~~~~Plot Inputs~~~~~~~~")
oversold = input.int(7, "Oversold Threshold", inline = "valuation", group = "~~~~~~~~Plot Inputs~~~~~~~~")
rsilength = input.int(14, "RSI Length", group = "~~~~~~~~Inputs~~~~~~~~")
cmolength = input.int(14, "CMO Length", group = "~~~~~~~~Inputs~~~~~~~~")
mfilength = input.int(14, "MFI Length", group = "~~~~~~~~Inputs~~~~~~~~")
smoothK = input.int(3, "K - Stoch", minval=1, group = "~~~~~~~~Inputs~~~~~~~~", inline = "stoch")
smoothD = input.int(3, "D - Stoch", minval=1, group = "~~~~~~~~Inputs~~~~~~~~", inline = "stoch")
lengthRSI = input.int(14, "RSI Length - Stoch ", minval=1, group = "~~~~~~~~Inputs~~~~~~~~", inline = "stoch")
lengthStoch = input.int(14, "Stochastic Length", minval=1, group = "~~~~~~~~Inputs~~~~~~~~", inline = "stoch")
rsisrc = input(close, title="RSI Source", group = "~~~~~~~~Inputs~~~~~~~~")
cmosrc = input(close, title="CMO Source", group = "~~~~~~~~Inputs~~~~~~~~")
mfisrc = input(close, title="MFI Source", group = "~~~~~~~~Inputs~~~~~~~~")
src = input(close, title="Stoch-RSI Source", group = "~~~~~~~~Inputs~~~~~~~~")
rsi1 = ta.rsi(src, lengthRSI)
k = ta.sma(ta.stoch(rsi1, rsi1, rsi1, lengthStoch), smoothK)
rsi = ta.rsi(rsisrc, rsilength)
cmo = ta.cmo(cmosrc, cmolength)
mfi = ta.mfi(mfisrc, mfilength)
hyperstrengthindex = (k+rsi+cmo+mfi)/4 


oversoldsignal =  hyperstrengthindex < oversold 
overboughtsignal = hyperstrengthindex > overbought
valuationcolor = hyperstrengthindex > overbought ? color.rgb(246, 28, 112, 60) : hyperstrengthindex < oversold ? color.rgb(28, 246, 137, 60) : color.rgb(0, 0, 0, 100)



plot(overbought, linestyle = plot.linestyle_dashed, color= color.gray, force_overlay = false)
plot(oversold, linestyle = plot.linestyle_dashed, color= color.gray, force_overlay = false)
plotshape(oversoldsignal, style = shape.triangleup,color = valuationcolor, location = location.belowbar, size = size.tiny, force_overlay = true)
plotshape(overboughtsignal, style = shape.triangledown,color = valuationcolor, location = location.abovebar, size = size.tiny, force_overlay = true)
bgcolor(valuationcolor, force_overlay = false)


plot(hyperstrengthindex, color = #2dbdc4, force_overlay = false)
