//@version=6
strategy("HMA 9/50 Crossover + RSI 50 Filter", overlay=true, initial_capital=1000, default_qty_type=strategy.percent_of_equity, default_qty_value=100)

// --- Inputs ---
fastLen = input.int(9, "Fast HMA Length")
slowLen = input.int(50, "Slow HMA Length")
rsiLen  = input.int(14, "RSI Length")
rsiThreshold = input.int(50, "RSI Momentum Level")

// --- Calculations ---
hmaFast = ta.hma(close, fastLen)
hmaSlow = ta.hma(close, slowLen)
rsiVal  = ta.rsi(close, rsiLen)

// --- Colors & Plotting ---
plot(hmaFast, color=color.aqua, linewidth=2, title="HMA 9")
plot(hmaSlow, color=color.orange, linewidth=2, title="HMA 50")

// Background highlights for RSI filter status
bgCol = rsiVal > rsiThreshold ? color.new(color.green, 90) : color.new(color.red, 90)
bgcolor(bgCol, title="RSI Trend Background")

// --- Strategy Logic ---
longCondition  = ta.crossover(hmaFast, hmaSlow) and rsiVal > rsiThreshold
shortCondition = ta.crossunder(hmaFast, hmaSlow) and rsiVal < (100 - rsiThreshold)

// --- Execution ---
if (longCondition and strategy.position_size <= 0)
    strategy.entry("Long", strategy.long, comment="HMA Cross + RSI > 50")

if (shortCondition and strategy.position_size >= 0)
    strategy.entry("Short", strategy.short, comment="HMA Cross + RSI < 50")

// --- Optional: Visual Labels ---
plotshape(longCondition, style=shape.triangleup, location=location.belowbar, color=color.green, size=size.small, title="Long Signal")
plotshape(shortCondition, style=shape.triangledown, location=location.abovebar, color=color.red, size=size.small, title="Short Signal")
