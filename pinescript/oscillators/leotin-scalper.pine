//@version=5
indicator("RSI + Candlestick Buy/Sell Alerts", overlay=true, timeframe="", timeframe_gaps=true)

// User inputs
rsiLength = input.int(14, "RSI Length")
overbought = input.int(70, "Overbought Level")
oversold = input.int(30, "Oversold Level")

// RSI calculation
rsi = ta.rsi(close, rsiLength)

// Candlestick components
body = math.abs(close - open)
upperWick = high - math.max(close, open)
lowerWick = math.min(close, open) - low

// Candlestick pattern logic
isHammer = lowerWick >= 2 * body and upperWick <= body and close > open
isInvertedHammer = upperWick >= 2 * body and lowerWick <= body and close > open
isHangingMan = lowerWick >= 2 * body and upperWick <= body and close < open
isShootingStar = upperWick >= 2 * body and lowerWick <= body and close < open

// Signal conditions
buySignal = rsi < oversold and (isHammer or isInvertedHammer)
sellSignal = rsi > overbought and (isHangingMan or isShootingStar)

// Plot signals on chart
plotshape(buySignal, title="Buy Signal", location=location.belowbar, color=color.green, style=shape.triangleup, size=size.large, text="BUY")
plotshape(sellSignal, title="Sell Signal", location=location.abovebar, color=color.red, style=shape.triangledown, size=size.large, text="SELL")

// Background highlight (optional)
bgcolor(buySignal ? color.new(color.green, 88) : sellSignal ? color.new(color.red, 88) : na)

// ALERTS
alertcondition(buySignal, title="Buy Signal", message="RSI Oversold + Hammer Pattern — BUY")
alertcondition(sellSignal, title="Sell Signal", message="RSI Overbought + Reversal Candle — SELL")
