//@version=5
indicator("Dual HTF RSI .88x Nanny ðŸ¦†ðŸ¥’ v1.0", overlay=true)

// ==========================================
// â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
// â•‘      SETTINGS: HTF RSI FILTER 1        â•‘
// â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// ==========================================
tf1   = input.timeframe("240", "ðŸ•’ Timeframe 1", group="â•â•â•â•â•â•â• RSI FILTER 1 â•â•â•â•â•â•â•")
min1  = input.int(40, "ðŸ“‰ Min (Crash Schutz)", minval=1, group="â•â•â•â•â•â•â• RSI FILTER 1 â•â•â•â•â•â•â•")
max1  = input.int(70, "ðŸ“ˆ Max (FOMO Schutz)", minval=50, group="â•â•â•â•â•â•â• RSI FILTER 1 â•â•â•â•â•â•â•")

// ==========================================
// â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
// â•‘      SETTINGS: HTF RSI FILTER 2        â•‘
// â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// ==========================================
tf2   = input.timeframe("D", "ðŸ•’ Timeframe 2", group="â•â•â•â•â•â•â• RSI FILTER 2 â•â•â•â•â•â•â•")
min2  = input.int(40, "ðŸ“‰ Min (Crash Schutz)", minval=1, group="â•â•â•â•â•â•â• RSI FILTER 2 â•â•â•â•â•â•â•")
max2  = input.int(70, "ðŸ“ˆ Max (FOMO Schutz)", minval=50, group="â•â•â•â•â•â•â• RSI FILTER 2 â•â•â•â•â•â•â•")

// ==========================================
// â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
// â•‘           COMMUNITY SECTION            â•‘
// â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// ==========================================
show_info = input.bool(true, "ðŸ¦† â¤ï¸", group="Von Horsti mit viel ðŸ¦† â¤ï¸ fÃ¼r die VIP Crypto Community gemacht.")

// ==========================================
// 3. DATENABFRAGE
// ==========================================
rsi1 = request.security(syminfo.tickerid, tf1, ta.rsi(close, 14), lookahead = barmerge.lookahead_off)
rsi2 = request.security(syminfo.tickerid, tf2, ta.rsi(close, 14), lookahead = barmerge.lookahead_off)

// ==========================================
// 4. FUNKTION FÃœR STATUS (ðŸ¦†/ðŸ¥’ Logik)
// ==========================================
get_rsi_status(val, mini, maxi) =>
    string txt = ""
    color col = color.gray
    string icon = ""
    
    if val < mini
        txt := "â›” CRASH (" + str.tostring(mini) + ")"
        col := color.red
        icon := "ðŸ¥’ " 
    else if val > maxi
        txt := "â›” FOMO (" + str.tostring(maxi) + ")"
        col := color.orange
        icon := "ðŸ¥’ " 
    else
        txt := "âœ… SAFE ZONE"
        col := color.green
        icon := "ðŸ¦† " 
        
    [icon + txt, col]

// ==========================================
// 5. INFO PANEL (OBEN RECHTS) - MIT ABSTANDHALTER
// ==========================================
// Tabelle mit 2 Spalten und 5 Zeilen (Zeile 0 = Abstand)
var table info_tbl = table.new(position.top_right, 2, 5, border_width=1, border_color=color.new(color.gray, 70))

if barstate.islast
    color bg_col = color.new(color.black, 40)
    color txt_col = color.white
    string my_text_size = size.normal 

    // --- ZEILE 0: LEERER ABSTANDHALTER ---
    table.cell(info_tbl, 0, 0, "", bgcolor=color.new(color.black, 100))
    table.cell(info_tbl, 1, 0, "", bgcolor=color.new(color.black, 100))

    // --- RSI 1 (Zeile 1 & 2) ---
    [st_display1, st_col1] = get_rsi_status(rsi1, min1, max1)
    
    table.cell(info_tbl, 0, 1, "HTF RSI (" + str.tostring(tf1) + ")", bgcolor=bg_col, text_color=color.gray, text_size=my_text_size)
    table.cell(info_tbl, 1, 1, str.tostring(rsi1, "#.##"), bgcolor=bg_col, text_color=txt_col, text_size=my_text_size)
    
    table.cell(info_tbl, 0, 2, "Status:", bgcolor=bg_col, text_color=color.gray, text_size=my_text_size)
    table.cell(info_tbl, 1, 2, st_display1, bgcolor=st_col1, text_color=txt_col, text_size=my_text_size)

    // --- RSI 2 (Zeile 3 & 4) ---
    [st_display2, st_col2] = get_rsi_status(rsi2, min2, max2)

    table.cell(info_tbl, 0, 3, "HTF RSI (" + str.tostring(tf2) + ")", bgcolor=bg_col, text_color=color.gray, text_size=my_text_size)
    table.cell(info_tbl, 1, 3, str.tostring(rsi2, "#.##"), bgcolor=bg_col, text_color=txt_col, text_size=my_text_size)
    
    table.cell(info_tbl, 0, 4, "Status:", bgcolor=bg_col, text_color=color.gray, text_size=my_text_size)
    table.cell(info_tbl, 1, 4, st_display2, bgcolor=st_col2, text_color=txt_col, text_size=my_text_size)
