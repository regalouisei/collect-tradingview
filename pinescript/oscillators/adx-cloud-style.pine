//@version=6
indicator("ADX Histogram & Cloud Style", shorttitle="ADX Cloud", overlay=false)

// --- USTAWIENIA ---
len = input.int(14, minval=1, title="Długość DI")
lensig = input.int(14, title="Długość ADX (Wygładzanie)")

// --- OBLICZENIA ---
// Funkcja ta.dmi zwraca krotkę (tuple) z trzema wartościami
[diplus, diminus, adx] = ta.dmi(len, lensig)

// Obliczanie różnicy dla histogramu
hist = diplus - diminus

// --- KOLORYSTYKA ---
col_plus = #00E676  // Zielony (byki)
col_minus = #FF5252 // Czerwony (niedźwiedzie)
col_adx = #2962FF   // Niebieski (siła trendu)

// Kolor histogramu (z przezroczystością 40)
col_hist = hist >= 0 ? color.new(col_plus, 40) : color.new(col_minus, 40)

// --- RYSOWANIE (PLOTTING) ---

// 1. Histogram
plot(hist, color=col_hist, style=plot.style_columns, title="Histogram (DI+ - DI-)", linewidth=2)

// 2. Linie DI+ i DI- (potrzebne do 'fill', ale widoczne jako obrys chmury)
p1 = plot(diplus, color=col_plus, title="DI+", linewidth=1)
p2 = plot(diminus, color=col_minus, title="DI-", linewidth=1)

// 3. Wypełnienie (Chmura)
// W wersji 6 fill działa tak samo: wypełnia obszar między p1 i p2
fill(p1, p2, color = diplus > diminus ? color.new(col_plus, 80) : color.new(col_minus, 80), title="Chmura DI")

// 4. Linia ADX
plot(adx, color=col_adx, title="ADX", linewidth=2)

// Linia zerowa
hline(0, "Poziom 0", color=color.gray, linestyle=hline.style_dotted)
