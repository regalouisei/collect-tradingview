//@version=6
indicator("Delta Volume RSI", overlay=false)

// Input parameters
period = input.int(14, title="RSI Period")

// Delta calculation by tick rule: positive or negative volume depending on price direction
deltaVolume = close > close[1] ? volume : close < close[1] ? -volume : 0

// Calculate average gains and losses of delta
gains = ta.rma(deltaVolume > 0 ? deltaVolume : 0, period)
losses = ta.rma(deltaVolume < 0 ? -deltaVolume : 0, period)

// Avoid division by zero
losses := losses == 0 ? 0.0001 : losses

// Calculate FR (Average Gains / Average Losses)
FR = gains / losses

// Calculate RSI (Relative Strength Index) based on delta volume
RSI = 100 - (100 / (1 + FR))

// Determine color: green above 50, red below 50
colorRSI = RSI >= 50 ? color.green : color.red

// Plot RSI with color change
plot(RSI, title="Delta Volume RSI", color=colorRSI, linewidth=2)

// Plot reference lines
hline(70, "Overbought", color=color.red)
hline(50, "Middle", color=color.gray, linestyle=hline.style_dashed)
hline(30, "Oversold", color=color.green)
