// This Pine Script® code is subject to the terms of the Mozilla Public License 2.0 at https://mozilla.org/MPL/2.0/
// © Shivam_Mandrai (Enhanced by Gemini)

//@version=6
indicator("IU Momentum Oscillator", overlay = false)

// ___________________ User Inputs ___________________ \\
// -------- Group Definitions ---------- \\
group_sett = "Calculations"
group_vis  = "Visuals"

// -------- Calculation Inputs ---------- \\
length    = input.int(20, "Momentum Length",    group = group_sett)
smoothing = input.int(20, "Momentum Smoothing", group = group_sett)
sig_len   = input.int(5,  "Signal Line Length", group = group_sett)

// -------- Visual Inputs ---------- \\
ob_level = input.float(60,      "Overbought Level", group = group_vis)
os_level = input.float(40,      "Oversold Level",   group = group_vis)
col_bull = input.color(#00FFFF, "Bullish Color",    group = group_vis) 
col_bear = input.color(#FF0080, "Bearish Color",    group = group_vis) 


// ___________________ Calculations ___________________ \\
// -------- Bullish Candle Count ---------- \\
is_bull      = close > open ? 1 : 0
bull_candles = math.sum(is_bull, length)

// -------- Momentum Logic ---------- \\
raw_momentum = (bull_candles / length) * 100
main_line    = ta.sma(raw_momentum, smoothing)
signal_line  = ta.ema(main_line, sig_len)


// ___________________ Visualization ___________________ \\
// -------- Dynamic Colors ---------- \\
color_dynamic = color.from_gradient(main_line, 40, 60, col_bear, col_bull)

// -------- Glow Effect (Shadow Plotting) ---------- \\
plot(main_line, "Glow Layer 1", color = color.new(color_dynamic, 80), linewidth = 6)
plot(main_line, "Glow Layer 2", color = color.new(color_dynamic, 50), linewidth = 3)
p_main = plot(main_line, "Main Line",    color = color_dynamic,            linewidth = 2)

// -------- Signal Line & Cloud ---------- \\
p_sig    = plot(signal_line, "Signal Line", color = color.new(color.gray, 50), linewidth = 1)
fill_col = main_line > signal_line ? color.new(col_bull, 85) : color.new(col_bear, 85)
fill(p_main, p_sig, fill_col, "Trend Cloud")

// -------- Levels & Zones ---------- \\
h_ob = hline(ob_level, "OB Level", color = color.new(col_bull, 50), linestyle = hline.style_dotted)
h_os = hline(os_level, "OS Level", color = color.new(col_bear, 50), linestyle = hline.style_dotted)

// Fill the extreme zones (above OB and below OS)
fill(h_ob, hline(100), color = color.new(col_bull, 90), title = "OB Zone Fill")
fill(h_os, hline(0),   color = color.new(col_bear, 90), title = "OS Zone Fill")

// -------- Crossover Signals ---------- \\
cross_up = ta.crossover(main_line, signal_line)
cross_dn = ta.crossunder(main_line, signal_line)

plotshape(cross_up ? signal_line - 2 : na, "Buy Signal",  shape.circle, location.absolute, color = col_bull, size = size.tiny)
plotshape(cross_dn ? signal_line + 2 : na, "Sell Signal", shape.circle, location.absolute, color = col_bear, size = size.tiny)
