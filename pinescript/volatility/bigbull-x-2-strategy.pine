//@version=5
strategy("bigbull X 2 Strategy", overlay=true,pyramiding=0,  initial_capital=10000, default_qty_type=strategy.fixed, default_qty_value=120, commission_type=strategy.commission.percent, commission_value=0.01,  slippage=2 ,process_orders_on_close=true)

//â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// DATE FILTER
//â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
startYear  = input.int(2012, "Start Year")
startMonth = input.int(9, "Start Month")
startDay   = input.int(22, "Start Day")
startDate  = timestamp(startYear, startMonth, startDay, 0, 0)

endYear   = input.int(2099, "End Year")
endMonth  = input.int(12, "End Month")
endDay    = input.int(31, "End Day")
endDate   = timestamp(endYear, endMonth, endDay, 23, 59)

isDateValid = time >= startDate and time <= endDate

//â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// TRADE SESSION
//â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
sessionTime = input.session("0915-1630", "Trade Session")
inSession   = not na(time(timeframe.period, sessionTime))

//â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// MOVING AVERAGES
//â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ema10 = ta.ema(close, 10)
ema20 = ta.ema(close, 20)
ema30 = ta.ema(close, 30)
sma20 = ta.sma(close, 20)
sma30 = ta.sma(close, 30)
sma50 = ta.sma(close, 50)

//â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// ROC
//â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
roc = ta.roc(close, 10)

//â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// SCORE (same logic)
//â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
score = 0
score += close > ema10 ? 1 : close < ema10 ? -1 : 0
score += close > ema20 ? 1 : close < ema20 ? -1 : 0
score += close > ema30 ? 1 : close < ema30 ? -1 : 0
score += close > sma20 ? 1 : close < sma20 ? -1 : 0
score += close > sma30 ? 1 : close < sma30 ? -1 : 0
score += close > sma50 ? 1 : close < sma50 ? -1 : 0

//â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// FINAL RATING
//â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
strongBuy  = score >= 9
buy        = score >= 4 and score < 9
neutral    = score > -4 and score < 4
sell       = score <= -4 and score > -9
strongSell = score <= -9

longSignal  = strongBuy or buy
shortSignal = strongSell or sell

//â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// MA CONDITIONS
//â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
maBull = close > ema10 and close > ema20 and close > ema30 and close > sma20 and close > sma30 and close > sma50
maBear = close < ema10 and close < ema20 and close < ema30 and close < sma20 and close < sma30 and close < sma50

buyAllowed     = longSignal  and roc > 0 and maBull
buyExitOnly    = longSignal  and (roc <= 0 or not maBull)
sellAllowed    = shortSignal and roc < 0 and maBear
sellExitOnly   = shortSignal and (roc >= 0 or not maBear)

//â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// ENTRY (DATE + SESSION ONLY)
//â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
if isDateValid and inSession
    if buyAllowed
        strategy.entry("Buy", strategy.long)
    if sellAllowed
        strategy.entry("Sell", strategy.short)

//â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// EXIT LOGIC
//â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
if buyExitOnly
    strategy.close("Sell")

if sellExitOnly
    strategy.close("Buy")

if neutral
    strategy.close("Buy")
    strategy.close("Sell")

//â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// ðŸ”¥ DAY END FORCE CLOSE (RENKO SAFE)
//â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
isDayEnd = not inSession and inSession[1]
if isDayEnd
    strategy.close_all(comment="Day End Square Off")
